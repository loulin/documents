# 前端规格说明书 (Front-end Specification)

## 1. 概述 (Overview)

本文档为“智能健康管理系统”的前端开发提供详细的UI、UX和组件规格。所有开发工作应严格遵循此文档，以确保产品体验的一致性和高质量。

## 2. 全局设计原则 (Global Design Principles)

- **可访问性优先 (Accessibility First):** 考虑到核心用户包含老年人，所有界面必须遵循以下原则：
    - **大字体:** 基础字体大小不应小于16px。
    - **高对比度:** 文本与背景色对比度需满足WCAG 2.1 AA级标准。
    - **清晰的点击区域:** 所有按钮、链接、表单控件必须有足够大的点击热区。
- **简洁直观:** 避免使用复杂或隐藏的交互（如悬停显示菜单），优先使用直接、明确的点击操作。
- **即时反馈:** 用户的每一个重要操作都应获得即时、清晰的视觉反馈。

## 3. 核心界面规格 (Core Interface Specifications)

### 3.1. 患者端App (Patient App)

#### 3.1.1. 布局与导航 (Layout & Navigation)

- **结构:** 采用底部标签栏 (Bottom Tab Bar) 布局。
- **标签页:**
    1.  **[对话]:** 默认主屏幕，包含 **F1: 统一智能对话界面**。
    2.  **[我的]:** 个人中心。包含用户基本信息，并提供通向 **F2: 健康历史记录视图** 的入口。

#### 3.1.2. 核心交互：AI智能识别与确认卡片

- **触发时机:** 用户发送消息后，如AI服务在后台识别出可结构化的健康数据，则在原始消息下方异步加载此卡片。
- **卡片设计:**
    - **标题:** "AI助手为您识别到以下健康记录"。
    - **内容:**
        - 每一项数据前都应有清晰的图标（如餐盘、血糖仪）。
        - 关键数据（如异常血糖值）应使用醒目颜色（如红色）高亮。
    - **操作区:**
        - **[修改] 按钮:** 点击后，弹出一个**模态框 (Modal)**，提供一个布局清晰、控件尺寸大的表单供用户编辑。
        - **[确认无误 ✓] 按钮:** 按钮尺寸需足够大，文字清晰。
- **交互反馈:**
    - 点击 **[确认无误 ✓]** 后，卡片背景变为浅绿色，显示一个大的 "✓ 已记录成功！" 标志，并在2-3秒后平滑消失或收起。

### 3.2. 医护端Web平台 (Clinician Web Platform)

#### 3.2.1. 布局与导航 (Layout & Navigation)

- **结构:** 采用顶部主导航标签页 (Top Tab Bar) 布局。
- **标签页:**
    1.  **[大屏仪表盘]:** 默认主页，对应 **F3: 患者列表与仪表盘**。
    2.  **[会话中心]:** 对应 **F4: 统一沟通与分析界面**。

#### 3.2.2. 界面：大屏仪表盘

- **筛选区:** 页面顶部提供按“姓名”、“标签”、“诊断”进行搜索和筛选的控件。
- **风险分区:** 页面主体分为四个明确的横向区域，有清晰的标题和背景色：
    - **极高风险 (Critical):** 红色背景
    - **高风险 (High):** 橙色背景
    - **中风险 (Medium):** 黄色背景
    - **低风险 (Low):** 绿色/灰色背景
- **患者卡片组件:**
    - **结构:** 卡片顶部为患者基本信息和风险标签。中部为过去24小时血糖波动迷你折线图。底部为最新一条消息摘要和“进入对话”按钮。
    - **交互:** 点击卡片任意位置或“进入对话”按钮，均可跳转至 **[会话中心]** 并定位到该患者。

#### 3.2.3. 界面：会话中心 (三栏式布局)

- **左栏：患者列表**
    - **顶部:** 提供一个即时搜索框，用于快速筛选患者列表。
    - **列表项:** 每一个列表项代表一个患者，包含：患者头像/姓名缩写、姓名、最新一条消息摘要、消息时间戳。若有未读消息，则显示一个红点标记。当前选中的患者聊天项应有高亮背景。
- **中栏：对话区域**
    - **顶部:** 显示当前选中患者的姓名、年龄、主要诊断和一个彩色的风险等级标签。旁边有一个“查看完整档案”的按钮和一个“升级给医生”的操作按钮。
    - **主体:** 完整的对话历史记录区域。患者消息、医护人员消息、系统提示消息（如“患者已确认健康记录”）应有不同的背景色或对齐方式以作区分。
    - **底部:** 一个富文本输入框，支持发送文字和表情。旁边是一个“发送”按钮。
- **右栏：AI分析与数据面板**
    - **结构:** 采用可折叠的区域 (Accordion) 或标签页 (Tabs) 设计，分为三个部分。
    - **区域1: 患者快照 (Patient Snapshot)**
        - **内容:** 显示患者的关键信息摘要，如姓名、年龄、联系方式、主要诊断、过敏史、当前风险等级、当前用药列表。
    - **区域2: 健康数据 (Health Data)**
        - **内容:** 提供一个交互式图表，可切换查看血糖、血压等关键指标在过去7天/30天/90天的趋势。图表下方是一个按时间倒序排列的、所有已确认的结构化健康事件流（饮食、症状、运动等）。
    - **区域3: AI建议 (AI Suggestions)**
        - **内容:** 根据患者最新的消息，动态生成3-5条回复建议。每条建议都是一个可点击的按钮，点击后内容会自动填充到中栏的输入框中。

#### 3.2.4. 界面：健康评估向导 (Health Assessment Wizard)

- **结构:** 这是一个分步骤的向导式表单，顶部有清晰的进度条。
- **数据来源:** 表单字段基于产品需求生成。所有字段均为**选填**。
- **排除字段:** **所有CGM相关指标** (TIR, TBR, GV, MAGE, MODD, LBGI, HBGI, GRI) **不作为**手动输入字段，这些由后端自动计算。

---

**评估步骤与字段详情:**

**第1步：基本信息**
- **字段:** 姓名, 出生日期, 性别, 联系方式

**第2步：血糖状态 (Glycemic Status)**
- **字段1: 诊断类型**
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 健康/未诊断, 糖尿病前期, 2型糖尿病, 1型糖尿病, 妊娠糖尿病, 特殊类型糖尿病
- **字段2: 特殊类型糖尿病详情 (条件显示)**
    - **显示规则:** 当“诊断类型”选择“特殊类型糖尿病”时显示。
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 单基因糖尿病 (MODY), 胰腺外分泌疾病, 药物或化学品诱导
- **字段3: HbA1c (%)**
    - **显示规则:** 当“诊断类型”为糖尿病相关时显示。
    - **控件:** 数字输入 (Number Input)
- **字段4: 严重低血糖事件史**
    - **显示规则:** 当“诊断类型”为糖尿病相关时显示。
    - **控件:** 单选按钮 (Radio Button)
    - **选项:** 无, 有

**第3步：并发症与合并症 (Complications & Comorbidities)**
- **说明:** 本部分所有字段均为复选框 (Checkbox)。
- **字段组1: 心脑血管系统 (条件显示)**
    - **显示规则:** 当患者年龄 >= 18岁时显示。
    - **选项:** 心肌梗死, 缺血性脑卒中, 心脏支架/搭桥手术, 心力衰竭, 外周动脉疾病
- **字段组2: 肾脏系统**
    - **选项:** 终末期肾病/透析, eGFR 45-59, eGFR 30-44, UACR 30-300 mg/g, UACR > 300 mg/g
- **字段组3: 其他合并症**
    - **选项:** 高血压未达标, 高血脂未达标, 非酒精性脂肪肝, 糖尿病视网膜病变 (条件显示), 糖尿病周围神经病变 (条件显示)

**第4步：个体背景与生活方式 (Background & Lifestyle)**
- **字段1: 糖尿病病程 (年)**
    - **显示规则:** 当“诊断类型”为糖尿病相关时显示。
    - **控件:** 数字输入 (Number Input)
- **字段2: 心血管疾病家族史**
    - **控件:** 单选按钮 (Radio Button)
    - **选项:** 无, 有
- **字段3: 体力活动**
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 
        - A. 每周至少进行150分钟中等强度运动 或 75分钟高强度运动，并包含2次以上抗阻训练。
        - B. 每周至少进行150分钟中等强度运动 或 75分钟高强度运动。
        - C. 每周能进行75-150分钟中等强度运动。
        - D. 每周运动不足75分钟，大部分时间久坐。
- **字段4: 饮食习惯**
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 
        - A. 遵循明确的健康饮食模式，营养均衡。
        - B. 有控制饮食的意识，但难以严格执行。
        - C. 经常食用高油、高盐、高糖食物。
- **字段5: 吸烟状况**
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 从不吸烟或已戒烟超过1年, 目前仍在吸烟
- **字段6: 睡眠质量**
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 每晚平均睡眠7-8小时，质量良好, 睡眠不足6小时或超过9小时，或质量不佳
- **字段7: 用药依从性 (条件显示)**
    - **显示规则:** 当“诊断类型”为糖尿病相关或有其他慢性病时显示。
    - **控件:** 下拉选择 (Dropdown)
    - **选项:** 
        - A. 能完全按照医嘱用药。
        - B. 偶尔 (每月1-2次) 漏服。
        - C. 经常 (每周≥1次) 漏服。

**第5步：完成评估**
- **内容:** 以只读形式展示前面所有步骤填写的摘要信息。
- **操作:** 提供 **[完成并生成风险评估]** 主按钮。
- **布局:** 
    - **核心结果区:** 页面视觉中心，用巨大、带颜色的字体显示**风险等级** (如“极高风险”)，并在其下方显示**具体分数**。
    - **关键风险因素区:** 以列表形式，清晰地展示导致该分数的**主要原因** (例如，“存在心肌梗死史 (风险倍率 x2.0)”, “HbA1c > 9.0%”)。
    - **下一步操作区:** 提供三个明确的按钮：**[✓ 纳入慢病管理]**, **[— 待定/稍后决定]**, **[x 暂不纳入]**。
    - **返回修改入口:** 提供一个“< 返回修改评估问卷”的链接。