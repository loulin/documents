# 临床科研数据模块 - 需求文档

## 1. 项目背景与目标

### 1.1. 项目目标
为了满足日益增长的临床科研需求，我们需要在现有糖尿病管理系统中构建一个功能强大、高度灵活的临床科研数据管理模块。该模块旨在支持医疗机构进行标准化的、纵向的（多时间点）临床数据收集与管理，并能同时支撑多个不同的科研项目。

### 1.2. 核心挑战
- **数据结构多样性**: 不同科研项目使用的CRF（病例报告表）可能完全不同。
- **时间序列数据**: 科研数据通常需要在不同时间点（如入组、3个月、1年）重复采集，形成纵向数据。
- **数据标准化**: 在保证灵活性的同时，需要对通用指标（如核心化验项）进行标准化，以支持跨项目的数据分析。

## 2. 核心概念定义

为实现项目目标，系统将围绕以下核心概念进行构建：

- **科研项目 (Research Project)**: 系统中的一个独立单元，代表一项具体的研究。每个项目可以有自己独特的配置和患者队列。
- **临床访视 (Clinical Visit)**: 患者在某个科研项目中的一次数据采集事件。所有动态数据都与"访视"关联，构成了数据的时间轴。
- **观测 (Observation)**: 系统中用于记录测量类数据的最小原子单位。无论是身高、体重还是HbA1c，都被抽象为一次"观测"，由"观测项编码"和"观测值"组成。
- **观测字典 (Observation Definition)**: 一个标准化的、集中管理所有"观测项"的字典，确保了数据的同质性和可比性。

## 3. 功能性需求 (Functional Requirements)

### FR1: 项目管理
- 系统管理员应能够创建、配置、归档科研项目。
- 项目配置应包括项目名称、描述等基本信息。

### FR2: 患者队列管理
- 研究人员应能够将系统内的患者招募/注册到特定的科研项目中。
- 系统应能清晰地展示每个项目中的患者列表。

### FR3: 数据采集与录入
- 系统应提供一个灵活的数据录入界面，能够动态适应不同CRF的采集需求。
- 数据录入应以"临床访视"为单位进行。
- **FR3.1**: 应支持患者固定历史信息（如既往史、家族史）的录入。
- **FR3.2**: 应支持访视动态信息（如体格检查、实验室检查、用药记录）的录入。
- **FR3.2.1**: **用药记录澄清**: 用药记录应捕获患者在访视期间的**常规用药方案 (Regimen)**，而非单次用药事件。记录内容需包括药物名称、每日服用频率、以及每次的详细剂量 (如每日三次，每次的剂量分别是多少)。
- **FR3.3**: 应支持与检查项关联的文件（如化验单照片、检查报告PDF）上传功能。

### FR4: 数据查询与可视化
- 研究人员应能够查看指定患者在某个项目内，按时间顺序排列的所有访视记录和数据。
- 系统应提供对"观测"数据的查询能力，例如，能够筛选出某项目所有患者的`hba1c`历史值。

### FR5: 数据导出
- 系统应支持将采集的数据以标准化格式（如CSV）导出，以供外部统计软件（如SPSS, R）进行分析。
- 导出功能应支持按项目、按患者、按观测项进行筛选。

## 4. 非功能性需求 (Non-Functional Requirements)

### NFR1: 灵活性与可扩展性
- **必须**支持在不修改数据库表结构、不重新部署后端服务的情况下，通过配置增加新的"观测项"。这是本模块设计的核心质量要求。

### NFR2: 数据完整性
- 所有写入"观测"表的数据，其`observation_code`必须在"观测字典"中存在。
- 系统应根据"观测字典"中定义的类型（数值/文本）对输入值进行校验。

### NFR3: 性能
- 对于大批量"观测"数据的查询（如趋势分析），系统应在5秒内响应。

### NFR4: 安全性
- 科研数据访问应与系统的权限管理紧密集成，只有参与该项目的研究人员才能访问相应数据。 