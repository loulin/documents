# CGMS传感器异常识别系统 - v2.0 使用说明

## 🚀 快速使用 (v2.0 重构版)

新版本引入了命令行参数和独立的配置文件，使用更灵活、更安全。**不再需要修改源代码**。

### 1. 默认分析
直接运行主程序，将使用默认的测试数据(`355582-1MH011ZGRFH-A.csv`)。
```bash
python3 约束优化真实数据分析.py
```

### 2. 分析您自己的文件
使用 `--input` 指定您的数据文件路径，使用 `--output` 指定结果图表的保存路径。
```bash
python3 约束优化真实数据分析.py --input "您的数据.csv" --output "分析结果.png"
```

### 3. 获取帮助
查看所有可用的命令行参数及其说明。
```bash
python3 约束优化真实数据分析.py --help
```

## 🔧 参数调整 (v2.0 新增)

所有核心算法的参数（如阈值、权重）都已被提取到 `config.py` 文件中，方便集中调整。

**当您需要微调算法时, 请修改 `config.py` 文件, 而不是主程序。**

例如，如果您想让统计学检测更严格，可以降低Z-score阈值：
```python
# in config.py
class Statistical:
    Z_SCORE_THRESHOLD = 2.0  # 原为 2.5
```

如果您想调整生理极限值的判断，可以修改：
```python
# in config.py
class Physiological:
    EXTREME_MAX_GLUCOSE = 380    # 原为 400
```

## 📁 文件结构 (v2.0)

```
探头状态异常识别/
├── config.py                    # ⚙️ 新增！参数配置文件
├── 约束优化真实数据分析.py        # 🎯 主程序
├── 多维度异常检测系统.py          # 📚 核心模块1 - 检测引擎
├── 多维度约束干扰分析系统.py       # 📚 核心模块2 - 约束分析引擎
├── 355582-1MH011ZGRFH-A.csv     # 📊 默认测试数据
├── 使用说明_最终版.md            # 📋 本文档
└── *.png                        # 📈 分析结果图表
```

## 📊 输出结果

程序运行后会生成：
1. **控制台输出**: 详细分析过程和统计结果。
2. **PNG图表**: 在您指定的路径生成分析图表。
3. **临床建议**: 基于分析结果的专业建议。

## 🎯 核心功能

(核心功能保持不变, 但实现方式更优)

### 1. 多维度异常检测
- 统计学异常检测
- 模式识别异常检测
- 频域分析异常检测
- 机器学习异常检测
- 生理学约束检验
- 时间序列分析

### 2. 约束优化过滤
- 生理学优先过滤
- 时间上下文过滤
- 方法一致性验证
- 置信度评分

### 3. 可视化输出
- 优化前后对比图
- 各方法贡献分析
- 置信度分布
- 综合统计摘要

## 🔧 技术架构 (v2.0)

### 依赖模块关系
```
约束优化真实数据分析.py (主程序)
├── 导入 → config.py (配置文件)
├── 导入 → 多维度异常检测系统.py
├── 导入 → 多维度约束干扰分析系统.py
└── 使用 → (通过 --input 参数指定的数据文件)
```

## 🔄 版本历史

### v2.0 - 重构与配置优化版 (当前版本)
- ✅ **命令行参数化**: 引入`--input`和`--output`参数，无需修改源码即可分析任意文件。
- ✅ **配置中心化**: 新增`config.py`，集中管理所有算法参数，便于调整。
- ✅ **健壮性增强**: 增加了输入文件格式验证和字体缺失的容错处理。
- ✅ **代码结构优化**: 优化了内部代码结构(如绘图函数)，提高了可读性和可维护性。
- ✅ **Bug修复**: 修复了重构过程中引入的`temporal_analysis`逻辑错误。

### v1.0 - 约束优化版 (旧版)
- ✅ 集成6维度异常检测
- ✅ 实现约束优化过滤
- ✅ 支持置信度分级
- ✅ 提供完整可视化
- ✅ 减少96.3%误报率

## 📞 使用支持

如需修改算法参数或适配新的数据格式，请参考：
- `config.py` - 调整算法行为
- `CGMS传感器异常识别方案.md` - 详细技术规范
- 代码内注释 - 具体实现细节

---
**更新时间**: 2025-10-01
**版本**: v2.0