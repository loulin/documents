<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent5ç»¼åˆè¡€ç³–åˆ†ææŠ¥å‘Š - å®Œæ•´Agent1+Agent2é›†æˆç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .report-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        .report-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .report-title {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        .report-subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .report-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.1);
            padding: 15px 25px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .patient-info, .analysis-info {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .patient-info h3, .analysis-info h3 {
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        /* æ ¸å¿ƒæŒ‡æ ‡ä»ªè¡¨ç›˜ */
        .metrics-dashboard {
            padding: 40px 30px;
            background: #f8f9fa;
        }
        
        .dashboard-title {
            text-align: center;
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .metric-value {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .metric-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .metric-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 500;
        }
        
        .status-excellent { background: #d4edda; color: #155724; }
        .status-good { background: #cce5ff; color: #004085; }
        .status-attention { background: #fff3cd; color: #856404; }
        .status-poor { background: #f8d7da; color: #721c24; }
        
        /* Agent1ä¸“ä¸šåˆ†æåŒºåŸŸ */
        .agent1-section {
            padding: 40px 30px;
            background: white;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.6em;
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #3498db;
        }
        
        .agent-badge {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.8em;
            font-weight: 500;
        }
        
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .module-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: border-color 0.3s ease;
        }
        
        .module-card:hover {
            border-color: #3498db;
        }
        
        .module-title {
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .indicator-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.9em;
        }
        
        .indicator-item {
            padding: 5px 8px;
            background: white;
            border-radius: 5px;
            color: #495057;
        }
        
        /* Agent2åˆ†æ®µåˆ†æåŒºåŸŸ */
        .agent2-section {
            padding: 40px 30px;
            background: #f8f9fa;
        }
        
        .segmentation-info {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .segmentation-details {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .optimization-stats {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }
        
        .segments-timeline {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }
        
        .segments-timeline::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: #3498db;
            z-index: 1;
        }
        
        .segment-point {
            background: white;
            border: 4px solid #3498db;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #3498db;
            position: relative;
            z-index: 2;
        }
        
        .segments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .segment-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .segment-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .segment-number {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .segment-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.9em;
        }
        
        .segment-metric {
            text-align: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        /* è„†æ€§æ£€æµ‹åŒºåŸŸ */
        .brittleness-section {
            padding: 40px 30px;
            background: white;
        }
        
        .brittleness-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .brittleness-card {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .brittleness-low { border-color: #28a745; background: #f8fff9; }
        .brittleness-medium { border-color: #ffc107; background: #fffef7; }
        .brittleness-high { border-color: #dc3545; background: #fff8f8; }
        
        .brittleness-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .brittleness-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .brittleness-label {
            font-size: 0.9em;
            color: #6c757d;
        }
        
        /* è¯ç‰©åˆ†æåŒºåŸŸ */
        .medication-section {
            padding: 40px 30px;
            background: #f8f9fa;
        }
        
        .medication-timeline {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .timeline-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 10px 0 10px 20px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .timeline-date {
            font-weight: bold;
            color: #3498db;
            min-width: 100px;
        }
        
        .timeline-content {
            flex: 1;
        }
        
        /* æ²»ç–—å»ºè®®åŒºåŸŸ */
        .recommendations-section {
            padding: 40px 30px;
            background: white;
        }
        
        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .recommendation-card {
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .short-term { background: linear-gradient(135deg, #e8f5e8, #d4edda); }
        .medium-term { background: linear-gradient(135deg, #e3f2fd, #bbdefb); }
        .long-term { background: linear-gradient(135deg, #fff3e0, #ffe0b2); }
        
        .recommendation-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .recommendation-list {
            list-style: none;
        }
        
        .recommendation-list li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .recommendation-list li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }
        
        /* æ•°æ®è´¨é‡åŒºåŸŸ */
        .quality-section {
            padding: 40px 30px;
            background: #f8f9fa;
        }
        
        .quality-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .quality-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .quality-grade {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .grade-a { color: #28a745; }
        .grade-b { color: #17a2b8; }
        .grade-c { color: #ffc107; }
        .grade-d { color: #dc3545; }
        
        /* é¡µè„š */
        .report-footer {
            padding: 30px;
            background: #2c3e50;
            color: white;
            text-align: center;
        }
        
        .footer-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .footer-section h4 {
            margin-bottom: 10px;
            color: #3498db;
        }
        
        .footer-section p {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .report-meta {
                flex-direction: column;
                gap: 15px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .segmentation-info {
                grid-template-columns: 1fr;
            }
            
            .segments-timeline {
                flex-wrap: wrap;
                gap: 20px;
            }
            
            .recommendations-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .metric-card, .module-card, .segment-card {
            animation: fadeInUp 0.6s ease forwards;
        }
        
        /* æ‰“å°æ ·å¼ */
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .report-container {
                box-shadow: none;
                border-radius: 0;
            }
            
            .report-header {
                background: #2c3e50 !important;
                -webkit-print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <div class="report-container">
        <!-- æŠ¥å‘Šå¤´éƒ¨ -->
        <header class="report-header">
            <h1 class="report-title">Agent5ç»¼åˆè¡€ç³–åˆ†ææŠ¥å‘Š</h1>
            <p class="report-subtitle">å®Œæ•´Agent1+Agent2é›†æˆç‰ˆ Â· ä¸“ä¸šçº§è¡€ç³–ç®¡ç†åˆ†æ</p>
            <div class="report-meta">
                <div class="patient-info">
                    <h3>ğŸ”¬ æ‚£è€…ä¿¡æ¯</h3>
                    <p>æ‚£è€…ID: <span id="patientId">æ¼”ç¤ºæ‚£è€…-001</span></p>
                    <p>ç›‘æµ‹å‘¨æœŸ: <span id="monitoringPeriod">13å¤©</span></p>
                </div>
                <div class="analysis-info">
                    <h3>ğŸ“Š åˆ†æè¯¦æƒ…</h3>
                    <p>æŠ¥å‘Šç‰ˆæœ¬: Agent5 v1.2</p>
                    <p>ç”Ÿæˆæ—¶é—´: <span id="reportTime">2025-09-03 17:01</span></p>
                </div>
            </div>
        </header>

        <!-- æ ¸å¿ƒæŒ‡æ ‡ä»ªè¡¨ç›˜ -->
        <section class="metrics-dashboard">
            <h2 class="dashboard-title">
                <span>ğŸ¥</span>
                æ ¸å¿ƒè¡€ç³–æŒ‡æ ‡ (Agent1å®Œæ•´åˆ†æ)
            </h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value" id="gmi">7.2%</div>
                    <div class="metric-label">è¡€ç³–ç®¡ç†æŒ‡æ ‡ (GMI)</div>
                    <div class="metric-status status-good">è‰¯å¥½æ§åˆ¶</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="tir">68.5%</div>
                    <div class="metric-label">ç›®æ ‡èŒƒå›´å†…æ—¶é—´ (TIR)</div>
                    <div class="metric-status status-good">æ¥è¿‘ç›®æ ‡</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="tar">28.1%</div>
                    <div class="metric-label">é«˜è¡€ç³–æ—¶é—´ (TAR)</div>
                    <div class="metric-status status-attention">éœ€è¦å…³æ³¨</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="tbr">3.4%</div>
                    <div class="metric-label">ä½è¡€ç³–æ—¶é—´ (TBR)</div>
                    <div class="metric-status status-excellent">å®‰å…¨èŒƒå›´</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="cv">25.0%</div>
                    <div class="metric-label">å˜å¼‚ç³»æ•° (CV)</div>
                    <div class="metric-status status-good">ç¨³å®šæ€§è‰¯å¥½</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="dataPoints">1,248</div>
                    <div class="metric-label">æ•°æ®ç‚¹æ•°</div>
                    <div class="metric-status status-excellent">æ•°æ®å……åˆ†</div>
                </div>
            </div>
        </section>

        <!-- Agent1ä¸“ä¸šåˆ†ææ¨¡å— -->
        <section class="agent1-section">
            <h2 class="section-title">
                <span class="agent-badge">Agent1</span>
                ä¸“ä¸šAGPåˆ†æ - 8å¤§æ¨¡å—94é¡¹æŒ‡æ ‡
            </h2>
            <div class="modules-grid">
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸ“‹</span>
                        æ¨¡å—1: æ•°æ®è´¨é‡è¯„ä¼°
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">ç›‘æµ‹è¦†ç›–ç‡ 98.2%</div>
                        <div class="indicator-item">æ•°æ®å®Œæ•´æ€§ ä¼˜ç§€</div>
                        <div class="indicator-item">ä¼ æ„Ÿå™¨å¯é æ€§ é«˜</div>
                        <div class="indicator-item">å¼‚å¸¸å€¼æ¯”ä¾‹ 1.8%</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸ“ˆ</span>
                        æ¨¡å—2: åŸºç¡€ç»Ÿè®¡æŒ‡æ ‡
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">å¹³å‡è¡€ç³– 7.2 mmol/L</div>
                        <div class="indicator-item">è¡€ç³–ä¸­ä½æ•° 6.8 mmol/L</div>
                        <div class="indicator-item">æ ‡å‡†å·® 1.8 mmol/L</div>
                        <div class="indicator-item">å››åˆ†ä½æ•°èŒƒå›´ 2.1</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸ¯</span>
                        æ¨¡å—3: CGMæ ¸å¿ƒæŒ‡æ ‡
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">GMI 7.2%</div>
                        <div class="indicator-item">TIR (3.9-10.0) 68.5%</div>
                        <div class="indicator-item">TAR-1 (10.0-13.9) 26.7%</div>
                        <div class="indicator-item">TBR-1 (3.0-3.9) 3.4%</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸ“Š</span>
                        æ¨¡å—4: å˜å¼‚æ€§æ·±åº¦åˆ†æ
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">CV 25.0%</div>
                        <div class="indicator-item">MAGE 4.2 mmol/L</div>
                        <div class="indicator-item">J-index 18.3</div>
                        <div class="indicator-item">LBGI/HBGI 2.1/8.7</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸ”„</span>
                        æ¨¡å—5: è¡€ç³–æ¨¡å¼è¯†åˆ«
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">æ˜¼å¤œèŠ‚å¾‹ æ­£å¸¸</div>
                        <div class="indicator-item">é¤åå³°å€¼ å¹³å‡8.9</div>
                        <div class="indicator-item">å¤œé—´ç¨³å®šæ€§ è‰¯å¥½</div>
                        <div class="indicator-item">é»æ˜ç°è±¡ è½»åº¦</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>âš ï¸</span>
                        æ¨¡å—6: ä½è¡€ç³–äº‹ä»¶åˆ†æ
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">ä½è¡€ç³–äº‹ä»¶ 3æ¬¡</div>
                        <div class="indicator-item">ä¸¥é‡ä½è¡€ç³– 0æ¬¡</div>
                        <div class="indicator-item">å¤œé—´ä½è¡€ç³– 1æ¬¡</div>
                        <div class="indicator-item">å¹³å‡æŒç»­æ—¶é—´ 23åˆ†é’Ÿ</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸ¥</span>
                        æ¨¡å—7: ä¸´åºŠè§£è¯»
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">æ•´ä½“æ§åˆ¶ è‰¯å¥½</div>
                        <div class="indicator-item">ç³–å°¿ç—…é£é™© ä¸­ç­‰</div>
                        <div class="indicator-item">å¹¶å‘ç—‡é£é™© ä½</div>
                        <div class="indicator-item">æ²»ç–—ä¾ä»æ€§ é«˜</div>
                    </div>
                </div>
                <div class="module-card">
                    <div class="module-title">
                        <span>ğŸš¨</span>
                        æ¨¡å—8: é£é™©è¯„ä¼°é¢„è­¦
                    </div>
                    <div class="indicator-list">
                        <div class="indicator-item">ç»¼åˆé£é™© ä¸­ä½é£é™©</div>
                        <div class="indicator-item">é¢„è­¦çº§åˆ« å…³æ³¨</div>
                        <div class="indicator-item">è¶‹åŠ¿åˆ†æ ç¨³å®šæ”¹å–„</div>
                        <div class="indicator-item">å¹²é¢„å»ºè®® ä¼˜åŒ–é¤å</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Agent2æ™ºèƒ½åˆ†æ®µåˆ†æ -->
        <section class="agent2-section">
            <h2 class="section-title">
                <span class="agent-badge">Agent2</span>
                æ™ºèƒ½æ—¶é—´åˆ†æ®µåˆ†æ - æœ€ä¼˜åˆ†æ®µç­–ç•¥
            </h2>
            
            <div class="segmentation-info">
                <div class="segmentation-details">
                    <h3>ğŸ§  åˆ†æ®µæŠ€æœ¯è¯¦æƒ…</h3>
                    <p><strong>æ£€æµ‹æ–¹æ³•:</strong> æ··æ²ŒåŠ¨åŠ›å­¦å˜åŒ–ç‚¹æ£€æµ‹</p>
                    <p><strong>æ£€æµ‹ç»´åº¦:</strong> ç»Ÿè®¡å­¦ã€èšç±»ã€æ¢¯åº¦ã€è„†æ€§æ¨¡å¼</p>
                    <p><strong>ä¼˜åŒ–ç­–ç•¥:</strong> æ™ºèƒ½é‡è¦æ€§è¯„åˆ†åˆå¹¶</p>
                    <p><strong>ä¸´åºŠå®ç”¨æ€§:</strong> æœ€ä½³ï¼ˆä¸´åºŠå‹å¥½ï¼‰</p>
                </div>
                
                <div class="optimization-stats">
                    <h3>ğŸ“Š ä¼˜åŒ–æ•ˆæœ</h3>
                    <div style="font-size: 2em; margin: 10px 0;">4æ®µ</div>
                    <p>æœ€ç»ˆåˆ†æ®µæ•°é‡</p>
                    <div style="margin-top: 15px; font-size: 0.9em;">
                        <p>åŸå§‹æ£€æµ‹: 7æ®µ</p>
                        <p>æ™ºèƒ½åˆå¹¶: 4æ®µ</p>
                        <p>å‹ç¼©ç‡: 42.9%</p>
                    </div>
                </div>
            </div>

            <div class="segments-timeline">
                <div class="segment-point">1</div>
                <div class="segment-point">2</div>
                <div class="segment-point">3</div>
                <div class="segment-point">4</div>
            </div>

            <div class="segments-grid">
                <div class="segment-card">
                    <div class="segment-header">
                        <div class="segment-number">1</div>
                        <div>
                            <strong>é˜¶æ®µ1</strong><br>
                            <small>08æœˆ20æ—¥-08æœˆ23æ—¥ï¼Œ3.2å¤©</small>
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 10px; background: #e8f5e8; border-radius: 5px;">
                        <strong>åŸºçº¿è¯„ä¼°é˜¶æ®µ</strong><br>
                        <small>åˆå§‹è¡€ç³–æ§åˆ¶çŠ¶æ€è¯„ä¼°</small>
                    </div>
                    <div class="segment-metrics">
                        <div class="segment-metric">
                            <strong>GMI</strong><br>7.8%
                        </div>
                        <div class="segment-metric">
                            <strong>TIR</strong><br>58.2%
                        </div>
                        <div class="segment-metric">
                            <strong>CV</strong><br>28.5%
                        </div>
                        <div class="segment-metric">
                            <strong>è´¨é‡</strong><br>éœ€æ”¹å–„
                        </div>
                    </div>
                </div>
                
                <div class="segment-card">
                    <div class="segment-header">
                        <div class="segment-number">2</div>
                        <div>
                            <strong>é˜¶æ®µ2</strong><br>
                            <small>08æœˆ23æ—¥-08æœˆ27æ—¥ï¼Œ3.8å¤©</small>
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 10px; background: #cce5ff; border-radius: 5px;">
                        <strong>æ²»ç–—è°ƒæ•´é˜¶æ®µ</strong><br>
                        <small>è¯ç‰©è°ƒæ•´åçš„é€‚åº”æœŸ</small>
                    </div>
                    <div class="segment-metrics">
                        <div class="segment-metric">
                            <strong>GMI</strong><br>7.3%
                        </div>
                        <div class="segment-metric">
                            <strong>TIR</strong><br>65.7%
                        </div>
                        <div class="segment-metric">
                            <strong>CV</strong><br>24.8%
                        </div>
                        <div class="segment-metric">
                            <strong>è´¨é‡</strong><br>è‰¯å¥½
                        </div>
                    </div>
                </div>
                
                <div class="segment-card">
                    <div class="segment-header">
                        <div class="segment-number">3</div>
                        <div>
                            <strong>é˜¶æ®µ3</strong><br>
                            <small>08æœˆ27æ—¥-08æœˆ30æ—¥ï¼Œ3.1å¤©</small>
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 10px; background: #d4edda; border-radius: 5px;">
                        <strong>ç¨³å®šæ”¹å–„é˜¶æ®µ</strong><br>
                        <small>è¡€ç³–æ§åˆ¶æ˜æ˜¾æ”¹å–„</small>
                    </div>
                    <div class="segment-metrics">
                        <div class="segment-metric">
                            <strong>GMI</strong><br>6.8%
                        </div>
                        <div class="segment-metric">
                            <strong>TIR</strong><br>74.3%
                        </div>
                        <div class="segment-metric">
                            <strong>CV</strong><br>22.1%
                        </div>
                        <div class="segment-metric">
                            <strong>è´¨é‡</strong><br>ä¼˜ç§€
                        </div>
                    </div>
                </div>
                
                <div class="segment-card">
                    <div class="segment-header">
                        <div class="segment-number">4</div>
                        <div>
                            <strong>é˜¶æ®µ4</strong><br>
                            <small>08æœˆ30æ—¥-09æœˆ02æ—¥ï¼Œ2.9å¤©</small>
                        </div>
                    </div>
                    <div style="margin: 15px 0; padding: 10px; background: #d4edda; border-radius: 5px;">
                        <strong>æœ€ä¼˜æ§åˆ¶é˜¶æ®µ</strong><br>
                        <small>è¾¾åˆ°æ²»ç–—ç›®æ ‡çŠ¶æ€</small>
                    </div>
                    <div class="segment-metrics">
                        <div class="segment-metric">
                            <strong>GMI</strong><br>6.5%
                        </div>
                        <div class="segment-metric">
                            <strong>TIR</strong><br>78.9%
                        </div>
                        <div class="segment-metric">
                            <strong>CV</strong><br>19.7%
                        </div>
                        <div class="segment-metric">
                            <strong>è´¨é‡</strong><br>ä¼˜ç§€
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- è„†æ€§è¡€ç³–æ£€æµ‹ -->
        <section class="brittleness-section">
            <h2 class="section-title">
                <span>ğŸ”</span>
                è¡€ç³–è„†æ€§æ£€æµ‹ - å¤šç»´åº¦è¯„ä¼°
            </h2>
            <div class="brittleness-grid">
                <div class="brittleness-card brittleness-low">
                    <div class="brittleness-icon">ğŸ“Š</div>
                    <div class="brittleness-value">25.0%</div>
                    <div class="brittleness-label">å˜å¼‚ç³»æ•° (CV)</div>
                    <div style="margin-top: 10px; color: #28a745; font-weight: 500;">âœ“ æ­£å¸¸èŒƒå›´</div>
                </div>
                <div class="brittleness-card brittleness-low">
                    <div class="brittleness-icon">âš¡</div>
                    <div class="brittleness-value">8.2%</div>
                    <div class="brittleness-label">æ€¥æ€§æ³¢åŠ¨é¢‘ç‡</div>
                    <div style="margin-top: 10px; color: #28a745; font-weight: 500;">âœ“ ç¨³å®šæ§åˆ¶</div>
                </div>
                <div class="brittleness-card brittleness-medium">
                    <div class="brittleness-icon">âš ï¸</div>
                    <div class="brittleness-value">31.5%</div>
                    <div class="brittleness-label">å±é™©åŒºé—´æ—¶é—´</div>
                    <div style="margin-top: 10px; color: #856404; font-weight: 500;">! éœ€è¦å…³æ³¨</div>
                </div>
                <div class="brittleness-card brittleness-low">
                    <div class="brittleness-icon">ğŸ“</div>
                    <div class="brittleness-value">9.8</div>
                    <div class="brittleness-label">è¡€ç³–èŒƒå›´ (mmol/L)</div>
                    <div style="margin-top: 10px; color: #28a745; font-weight: 500;">âœ“ å¯æ¥å—èŒƒå›´</div>
                </div>
            </div>
            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107;">
                <strong>ğŸ” è„†æ€§è¯„ä¼°ç»“è®º:</strong> æ£€æµ‹åˆ°<strong>ä¸­åº¦è„†æ€§</strong>ç‰¹å¾ï¼Œä¸»è¦è¡¨ç°ä¸ºå±é™©åŒºé—´æ—¶é—´åé«˜ã€‚å»ºè®®é‡ç‚¹å…³æ³¨é«˜è¡€ç³–æ—¶é—´çš„æ§åˆ¶ï¼Œå…¶ä»–ç»´åº¦è¡¨ç°è‰¯å¥½ã€‚å·²è‡ªåŠ¨å¯ç”¨Agent2å®Œæ•´åˆ†ææ¨¡å¼ã€‚
            </div>
        </section>

        <!-- è¯ç‰©åˆ†æ -->
        <section class="medication-section">
            <h2 class="section-title">
                <span>ğŸ’Š</span>
                ç”¨è¯åˆ†æä¸æ²»ç–—æ—¶é—´çº¿
            </h2>
            <div class="medication-timeline">
                <h3>ğŸ“… ç”¨è¯æ—¶é—´çº¿</h3>
                <div class="timeline-item">
                    <div class="timeline-date">07-20</div>
                    <div class="timeline-content">
                        <strong>å¼€å§‹äºŒç”²åŒèƒå•è¯æ²»ç–—</strong><br>
                        äºŒç”²åŒèƒç‰‡ 0.5gï¼Œæ¯æ—¥3æ¬¡ï¼Œä¸‰é¤å‰30åˆ†é’Ÿ<br>
                        <small>ç›®çš„: åŸºç¡€é™ç³–ï¼Œæ”¹å–„èƒ°å²›ç´ æŠµæŠ—</small>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">08-02</div>
                    <div class="timeline-content">
                        <strong>åŠ ç”¨è¾¾æ ¼åˆ—å‡€ç‰‡</strong><br>
                        è¾¾æ ¼åˆ—å‡€ç‰‡ 10mgï¼Œæ¯æ—¥1æ¬¡ï¼Œæ—©é¤å‰<br>
                        <small>åŸå› : ç©ºè…¹è¡€ç³–æ§åˆ¶ä¸ç†æƒ³ï¼ŒSGLT-2æŠ‘åˆ¶ä¿ƒè¿›è‘¡è„ç³–æ’æ³„</small>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">08-06</div>
                    <div class="timeline-content">
                        <strong>åŠ ç”¨è¥¿æ ¼åˆ—æ±€ç‰‡</strong><br>
                        è¥¿æ ¼åˆ—æ±€ç‰‡ 100mgï¼Œæ¯æ—¥1æ¬¡ï¼Œæ—©é¤å<br>
                        <small>åŸå› : é¤åè¡€ç³–ä»é«˜ï¼ŒDPP-4æŠ‘åˆ¶æ”¹å–„é¤åè¡€ç³–</small>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">08-10</div>
                    <div class="timeline-content">
                        <strong>ä¸‰è¯è”åˆæ²»ç–—ç¨³å®šæœŸ</strong><br>
                        é€šè¿‡Agent5åˆ†æè¯„ä¼°æ²»ç–—æ•ˆæœ<br>
                        <small>æ¸è¿›å¼åŠ è¯ç­–ç•¥ï¼Œå¤šé¶ç‚¹æ²»ç–—æ”¹å–„è¡€ç³–æ§åˆ¶</small>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ²»ç–—å»ºè®® -->
        <section class="recommendations-section">
            <h2 class="section-title">
                <span>ğŸ’¡</span>
                ä¸ªæ€§åŒ–æ²»ç–—å»ºè®®
            </h2>
            <div class="recommendations-grid">
                <div class="recommendation-card short-term">
                    <div class="recommendation-title">
                        <span>ğŸ¯</span>
                        çŸ­æœŸå»ºè®® (1-4å‘¨)
                    </div>
                    <ul class="recommendation-list">
                        <li>ç»´æŒç°æœ‰ä¸‰è¯è”åˆæ–¹æ¡ˆï¼Œæ²»ç–—æ•ˆæœè‰¯å¥½</li>
                        <li>é‡ç‚¹å…³æ³¨é¤åè¡€ç³–æ§åˆ¶ï¼Œé€‚å½“è°ƒæ•´è¿›é¤æ—¶é—´</li>
                        <li>åŠ å¼ºè¡€ç³–ç›‘æµ‹é¢‘ç‡ï¼Œç‰¹åˆ«æ˜¯é¤å2å°æ—¶</li>
                        <li>æ³¨æ„ä½è¡€ç³–é¢„é˜²æªæ–½ï¼Œéšèº«å¤‡ç”¨è‘¡è„ç³–</li>
                    </ul>
                </div>
                <div class="recommendation-card medium-term">
                    <div class="recommendation-title">
                        <span>ğŸ“ˆ</span>
                        ä¸­æœŸå»ºè®® (1-3ä¸ªæœˆ)
                    </div>
                    <ul class="recommendation-list">
                        <li>å®šæœŸå¤æŸ¥è¯„ä¼°ï¼Œå»ºè®®4-6å‘¨åå¤è¯Š</li>
                        <li>åŸºäºåˆ†æ®µåˆ†æåˆ¶å®šä¸ªæ€§åŒ–ç®¡ç†è®¡åˆ’</li>
                        <li>é‡ç‚¹å…³æ³¨åˆ†æ®µå˜åŒ–è¶‹åŠ¿çš„ä¸´åºŠæ„ä¹‰</li>
                        <li>ä¼˜åŒ–ç”Ÿæ´»æ–¹å¼ï¼Œé…åˆè¯ç‰©æ²»ç–—</li>
                    </ul>
                </div>
                <div class="recommendation-card long-term">
                    <div class="recommendation-title">
                        <span>ğŸ–ï¸</span>
                        é•¿æœŸå»ºè®® (3-6ä¸ªæœˆ)
                    </div>
                    <ul class="recommendation-list">
                        <li>å»ºç«‹é•¿æœŸè¡€ç³–ç®¡ç†è®¡åˆ’</li>
                        <li>é¢„é˜²ç³–å°¿ç—…æ…¢æ€§å¹¶å‘ç—‡</li>
                        <li>å®šæœŸè¯„ä¼°æ²»ç–—ç›®æ ‡è¾¾æˆæƒ…å†µ</li>
                        <li>è€ƒè™‘èƒ°å²›åŠŸèƒ½ä¿æŠ¤ç­–ç•¥</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- æ•°æ®è´¨é‡è¯„ä¼° -->
        <section class="quality-section">
            <h2 class="section-title">
                <span>ğŸ”¬</span>
                æ•°æ®è´¨é‡ä¸å¯é æ€§è¯„ä¼°
            </h2>
            <div class="quality-metrics">
                <div class="quality-card">
                    <div class="quality-grade grade-a">Açº§</div>
                    <div><strong>æ•°æ®è´¨é‡ç­‰çº§</strong></div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        æ•°æ®å¯†åº¦é«˜ï¼Œé€‚åˆç²¾ç»†åˆ†æ
                    </div>
                </div>
                <div class="quality-card">
                    <div style="font-size: 1.5em; font-weight: bold; color: #2c3e50;">1,248</div>
                    <div><strong>æ€»æ•°æ®ç‚¹</strong></div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        13å¤©ç›‘æµ‹å‘¨æœŸ
                    </div>
                </div>
                <div class="quality-card">
                    <div style="font-size: 1.5em; font-weight: bold; color: #2c3e50;">96.0</div>
                    <div><strong>å¹³å‡è¯»æ•°/å¤©</strong></div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        ç›‘æµ‹å¯†åº¦å……åˆ†
                    </div>
                </div>
                <div class="quality-card">
                    <div style="font-size: 1.5em; font-weight: bold; color: #28a745;">98.2%</div>
                    <div><strong>æ•°æ®å®Œæ•´æ€§</strong></div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        ä¼˜ç§€çš„ç›‘æµ‹ä¾ä»æ€§
                    </div>
                </div>
            </div>
        </section>

        <!-- æŠ¥å‘Šé¡µè„š -->
        <footer class="report-footer">
            <div class="footer-info">
                <div class="footer-section">
                    <h4>ğŸ”¬ æŠ€æœ¯æ¶æ„</h4>
                    <p>Agent1: 94é¡¹ä¸“ä¸šAGPæŒ‡æ ‡å®Œæ•´åˆ†æ</p>
                    <p>Agent2: æ··æ²ŒåŠ¨åŠ›å­¦æ™ºèƒ½æ—¶é—´åˆ†æ®µ</p>
                    <p>Agent5: å®Œæ•´é›†æˆç»¼åˆåˆ†æå¼•æ“</p>
                </div>
                <div class="footer-section">
                    <h4>ğŸ“Š åˆ†æç‰¹è‰²</h4>
                    <p>å¤šç»´åº¦è„†æ€§è¡€ç³–æ£€æµ‹</p>
                    <p>æœ€ä¼˜2-4æ®µä¸´åºŠå‹å¥½åˆ†æ®µ</p>
                    <p>æ™ºèƒ½é‡è¦æ€§è¯„åˆ†åˆå¹¶ç®—æ³•</p>
                </div>
                <div class="footer-section">
                    <h4>ğŸ¯ ä¸´åºŠåº”ç”¨</h4>
                    <p>ä¸ªæ€§åŒ–æ²»ç–—ç­–ç•¥åˆ¶å®š</p>
                    <p>åˆ†é˜¶æ®µè¡€ç³–ç®¡ç†ä¼˜åŒ–</p>
                    <p>å¾ªè¯åŒ»å­¦å†³ç­–æ”¯æŒ</p>
                </div>
                <div class="footer-section">
                    <h4>â„¹ï¸ ç‰ˆæœ¬ä¿¡æ¯</h4>
                    <p>Agent5 ç»¼åˆåˆ†æå™¨ v1.2</p>
                    <p>å®Œæ•´Agent1+Agent2é›†æˆç‰ˆ</p>
                    <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´: <span id="footerTime">2025-09-03</span></p>
                </div>
            </div>
            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #34495e; font-size: 0.9em; opacity: 0.8;">
                <p>æœ¬æŠ¥å‘ŠåŸºäºè¿ç»­è¡€ç³–ç›‘æµ‹æ•°æ®ï¼Œç»“åˆä¸“ä¸šAGPåˆ†æå’Œæ™ºèƒ½æ—¶é—´åˆ†æ®µæŠ€æœ¯ç”Ÿæˆã€‚å»ºè®®ç»“åˆä¸´åºŠæƒ…å†µç»¼åˆåˆ¤æ–­ï¼Œå®šæœŸå¤æŸ¥è¯„ä¼°æ²»ç–—æ•ˆæœã€‚</p>
            </div>
        </footer>
    </div>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®å½“å‰æ—¶é—´
            const now = new Date();
            const timeString = now.getFullYear() + '-' + 
                             String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                             String(now.getDate()).padStart(2, '0') + ' ' +
                             String(now.getHours()).padStart(2, '0') + ':' + 
                             String(now.getMinutes()).padStart(2, '0');
            
            document.getElementById('reportTime').textContent = timeString;
            document.getElementById('footerTime').textContent = timeString.split(' ')[0];
            
            // æ·»åŠ æ‰“å°åŠŸèƒ½
            if (window.matchMedia && window.matchMedia('(max-width: 768px)').matches) {
                // ç§»åŠ¨ç«¯ä¼˜åŒ–
                document.body.style.fontSize = '14px';
            }
            
            // åŠ¨ç”»å»¶è¿Ÿæ•ˆæœ
            const cards = document.querySelectorAll('.metric-card, .module-card, .segment-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = (index * 0.1) + 's';
            });
        });
        
        // æ‰“å°åŠŸèƒ½
        function printReport() {
            window.print();
        }
        
        // æ•°æ®æ›´æ–°å‡½æ•°ï¼ˆå¯ä»¥é€šè¿‡JavaScriptåŠ¨æ€æ›´æ–°æŠ¥å‘Šæ•°æ®ï¼‰
        function updateReportData(data) {
            if (data.patientId) document.getElementById('patientId').textContent = data.patientId;
            if (data.gmi) document.getElementById('gmi').textContent = data.gmi;
            if (data.tir) document.getElementById('tir').textContent = data.tir;
            if (data.tar) document.getElementById('tar').textContent = data.tar;
            if (data.tbr) document.getElementById('tbr').textContent = data.tbr;
            if (data.cv) document.getElementById('cv').textContent = data.cv;
            if (data.dataPoints) document.getElementById('dataPoints').textContent = data.dataPoints.toLocaleString();
        }
    </script>
</body>
</html>