# AGPAI - Advanced Glucose Pattern Analysis with Intelligence

## æ¦‚è¿°

AGPAIæ˜¯ä¸€ä¸ªåŸºäºæ··æ²Œç†è®ºå’Œäººå·¥æ™ºèƒ½çš„é«˜çº§è¡€ç³–æ¨¡å¼åˆ†æç³»ç»Ÿï¼Œä¸“ä¸ºä¸´åºŠè¡€ç³–ç®¡ç†å’Œç³–å°¿ç—…ç²¾å‡†æ²»ç–—è®¾è®¡ã€‚ç³»ç»Ÿé‡‡ç”¨ä¸‰AgentååŒæ¶æ„ï¼Œç»“åˆæ‰‹åŠ¨åˆ‡ç‚¹ç®¡ç†å’Œåˆ†æ®µè„†æ€§åˆ†æï¼Œä¸ºèƒ°è…ºå¤–ç§‘ç­‰ä¸“ä¸šåœºæ™¯æä¾›ç²¾å‡†çš„è¡€ç³–è„†æ€§è¯„ä¼°å’Œæ²»ç–—æ•ˆæœè¿½è¸ªã€‚

## ğŸ¯ ç³»ç»Ÿæ¶æ„

### ä¸‰AgentååŒç³»ç»Ÿ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent 1: AGPä¸“ä¸šåˆ†æå™¨    â”‚  Agent 2: è„†æ€§ä¸´åºŠé¡¾é—®         â”‚
â”‚  - 94é¡¹ä¸“ä¸šæŒ‡æ ‡           â”‚  - 6ç§è„†æ€§åˆ†å‹                â”‚
â”‚  - ä¼ ç»Ÿ+é«˜çº§æŒ‡æ ‡          â”‚  - æ··æ²Œç†è®ºåˆ†æ               â”‚
â”‚  - å›½é™…æ ‡å‡†å…¼å®¹           â”‚  - ä¸ªæ€§åŒ–æ²»ç–—å»ºè®®             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent 3: ç»¼åˆæ™ºèƒ½åˆ†æå™¨   â”‚  åˆ‡ç‚¹æ£€æµ‹å’Œåˆ†æ®µåˆ†æç³»ç»Ÿ        â”‚
â”‚  - 120é¡¹æ‰©å±•æŒ‡æ ‡          â”‚  - è‡ªåŠ¨åˆ‡ç‚¹æ£€æµ‹               â”‚
â”‚  - å¤šç»´åº¦ç»¼åˆåˆ†æ         â”‚  - æ‰‹åŠ¨åˆ‡ç‚¹ç®¡ç†               â”‚
â”‚  - é¢„æµ‹æ€§å»ºæ¨¡             â”‚  - åˆ†æ®µè„†æ€§åˆ†æ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ§  ä¸‰Agentæ™ºèƒ½ååŒ
- **Agent 1**: AGP Professional Analyzer - 94é¡¹ä¸“ä¸šæŒ‡æ ‡åˆ†æ
- **Agent 2**: Brittleness Clinical Advisor - è¡€ç³–è„†æ€§åˆ†å‹å’Œä¸´åºŠå»ºè®®  
- **Agent 3**: Comprehensive Intelligence Analyzer - 120é¡¹ç»¼åˆæ™ºèƒ½åˆ†æ

### ğŸ”¬ å…ˆè¿›ç®—æ³•æŠ€æœ¯
- **æ··æ²Œç†è®ºåˆ†æ**: LyapunovæŒ‡æ•°ã€è¿‘ä¼¼ç†µã€Shannonç†µ
- **è„†æ€§æ™ºèƒ½åˆ†å‹**: 6ç§è¡€ç³–è„†æ€§ç±»å‹çš„ç²¾å‡†è¯†åˆ«
- **å¤æ‚åº¦è¯„ä¼°**: å¤šç»´åº¦è¡€ç³–å¤æ‚æ€§é‡åŒ–åˆ†æ
- **é¢„æµ‹æ€§å»ºæ¨¡**: åŸºäºå†å²æ¨¡å¼çš„è¶‹åŠ¿é¢„æµ‹

### ğŸ¥ ä¸´åºŠæ™ºèƒ½åˆ‡ç‚¹ç³»ç»Ÿ
- **æ‰‹åŠ¨åˆ‡ç‚¹ç®¡ç†**: æ”¯æŒ12ç§ä¸“ä¸šæ²»ç–—è°ƒæ•´åˆ‡ç‚¹æ ‡æ³¨
- **è‡ªåŠ¨åˆ‡ç‚¹æ£€æµ‹**: å¤šç®—æ³•èåˆçš„æ™ºèƒ½æ—¶é—´ç‚¹è¯†åˆ«
- **åˆ†æ®µè„†æ€§åˆ†æ**: æ²»ç–—å‰åè¡€ç³–è„†æ€§å˜åŒ–è¿½è¸ª
- **æ•ˆæœè¯„ä¼°**: é‡åŒ–æ²»ç–—æ•ˆæœå’Œä¸ªæ€§åŒ–å»ºè®®

### ğŸ“Š ä¸“ä¸šä¸´åºŠæŒ‡æ ‡
- **ä¼ ç»Ÿæ ¸å¿ƒæŒ‡æ ‡**: TIRã€CVã€GMIã€MAGEç­‰å›½é™…æ ‡å‡†æŒ‡æ ‡
- **é«˜çº§æ··æ²ŒæŒ‡æ ‡**: ç³»ç»Ÿç¨³å®šæ€§å’Œå¯é¢„æµ‹æ€§åˆ†æ
- **è„†æ€§ç‰¹å¾æŒ‡æ ‡**: è¡€ç³–è°ƒèŠ‚ç³»ç»Ÿè„†å¼±æ€§è¯„ä¼°
- **ä¸ªæ€§åŒ–é£é™©è¯„ä¼°**: åŸºäºä¸ªä½“ç‰¹å¾çš„é£é™©åˆ†å±‚

## ğŸ“¦ ç›®å½•ç»“æ„

### æ ¸å¿ƒæ¨¡å— (agpai/)
```
agpai/
â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ config.yaml           # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config_manager.py     # é…ç½®ç®¡ç†å™¨
â”‚   â””â”€â”€ *.csv                 # å‚æ•°é…ç½®è¡¨
â”œâ”€â”€ core/            # æ ¸å¿ƒåˆ†æå¼•æ“
â”‚   â”œâ”€â”€ AGP_Professional_Analyzer.py          # Agent 1
â”‚   â”œâ”€â”€ Brittleness_Clinical_Advisor.py       # Agent 2  
â”‚   â”œâ”€â”€ Comprehensive_Intelligence_Analyzer.py # Agent 3
â”‚   â”œâ”€â”€ Multi_Agent_Coordinator.py            # Agentåè°ƒå™¨
â”‚   â”œâ”€â”€ Treatment_Cutpoint_Detector.py        # åˆ‡ç‚¹æ£€æµ‹å™¨
â”‚   â”œâ”€â”€ Manual_Cutpoint_Manager.py            # æ‰‹åŠ¨åˆ‡ç‚¹ç®¡ç†
â”‚   â”œâ”€â”€ Segmented_Brittleness_Analyzer.py     # åˆ†æ®µåˆ†æå™¨
â”‚   â””â”€â”€ ...                                   # å…¶ä»–æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ examples/        # ç¤ºä¾‹å’Œæ¼”ç¤º
â”‚   â”œâ”€â”€ AGPAI_Complete_Enhanced_Demo.py       # å®Œæ•´æ¼”ç¤º
â”‚   â”œâ”€â”€ Manual_Cutpoint_Demo.py               # æ‰‹åŠ¨åˆ‡ç‚¹æ¼”ç¤º
â”‚   â”œâ”€â”€ Pancreatic_Surgery_Cutpoint_Demo.py   # èƒ°è…ºå¤–ç§‘æ¼”ç¤º
â”‚   â””â”€â”€ ...
â”œâ”€â”€ docs/            # æ–‡æ¡£
â”‚   â”œâ”€â”€ Manual_Cutpoint_System_Guide.md       # æ‰‹åŠ¨åˆ‡ç‚¹ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ System_Architecture_Update.md         # ç³»ç»Ÿæ¶æ„æ–‡æ¡£
â”‚   â””â”€â”€ ...
â”œâ”€â”€ tests/           # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ visualization/   # å¯è§†åŒ–æ¨¡å—
â””â”€â”€ reports/         # åˆ†ææŠ¥å‘Šè¾“å‡º
```

## ğŸ”¥ æ ¸å¿ƒåŠŸèƒ½

### 1. è¡€ç³–è„†æ€§åˆ†å‹ç³»ç»Ÿ
**6ç§è„†æ€§ç±»å‹æ™ºèƒ½è¯†åˆ«**ï¼š
- **Iå‹æ··æ²Œè„†æ€§**: æä¸ç¨³å®šï¼Œå¤§å¹…éšæœºæ³¢åŠ¨
- **IIå‹å‡†å‘¨æœŸè„†æ€§**: ä¸­ç­‰æ··æ²Œç‰¹å¾ï¼Œå‡†å‘¨æœŸæ³¢åŠ¨  
- **IIIå‹éšæœºè„†æ€§**: é«˜å˜å¼‚ä¸”æ— ç›¸å…³æ€§
- **IVå‹è®°å¿†ç¼ºå¤±è„†æ€§**: è¡€ç³–è°ƒèŠ‚ç³»ç»Ÿå¤±å»'è®°å¿†'åŠŸèƒ½
- **Vå‹é¢‘åŸŸè„†æ€§**: è¡€ç³–èŠ‚å¾‹å®Œå…¨ç´Šä¹±
- **ç¨³å®šå‹**: è¡€ç³–è°ƒèŠ‚ç³»ç»Ÿç¨³å®š

### 2. æ‰‹åŠ¨åˆ‡ç‚¹ç®¡ç†ç³»ç»Ÿ
**12ç§ä¸“ä¸šåˆ‡ç‚¹ç±»å‹**ï¼š
- **æ‰‹æœ¯ç±»**: èƒ°è…ºæ‰‹æœ¯ã€èƒ†å›Šæ‰‹æœ¯
- **è¯ç‰©ç±»**: èƒ°å²›ç´ å¯åŠ¨/è°ƒæ•´ã€å£æœè¯è°ƒæ•´ã€æ¿€ç´ æ²»ç–—
- **è¥å…»ç±»**: TPNå¯åŠ¨ã€TPNè½¬ENã€é¥®é£Ÿæ¢å¤
- **äº‹ä»¶ç±»**: æ„ŸæŸ“ã€åº”æ¿€ååº”ã€å‡ºé™¢å‡†å¤‡

**æ™ºèƒ½éªŒè¯åŠŸèƒ½**ï¼š
- æ—¶é—´åˆç†æ€§æ£€æŸ¥
- é¢„æœŸæ•ˆåº”éªŒè¯  
- æ•°æ®å®Œæ•´æ€§è¯„ä¼°

### 3. åˆ†æ®µè„†æ€§åˆ†æ
**æ²»ç–—æ•ˆæœé‡åŒ–è¯„ä¼°**ï¼š
- æ®µå†…è„†æ€§åˆ†å‹å˜åŒ–
- æ®µé—´ç»Ÿè®¡æ˜¾è‘—æ€§æ¯”è¾ƒ
- ä¸´åºŠæ”¹å–„åº¦è¯„åˆ†
- ä¸ªæ€§åŒ–æ²»ç–—å»ºè®®

### 4. 94é¡¹ä¸“ä¸šæŒ‡æ ‡åˆ†æ
**ä¼ ç»Ÿæ ¸å¿ƒæŒ‡æ ‡**ï¼š
- TIR (Time in Range)
- CV (å˜å¼‚ç³»æ•°)
- GMI (è¡€ç³–ç®¡ç†æŒ‡æ ‡)
- MAGE (å¹³å‡è¡€ç³–æ³¢åŠ¨å¹…åº¦)

**é«˜çº§æ··æ²ŒæŒ‡æ ‡**ï¼š
- LyapunovæŒ‡æ•° (ç³»ç»Ÿç¨³å®šæ€§)
- è¿‘ä¼¼ç†µ (å¤æ‚åº¦)
- Shannonç†µ (ä¿¡æ¯é‡)
- HurstæŒ‡æ•° (é•¿ç¨‹è®°å¿†)

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚
```bash
Python >= 3.8
numpy >= 1.20.0
pandas >= 1.3.0
scipy >= 1.7.0
scikit-learn >= 1.0.0
matplotlib >= 3.5.0
openpyxl >= 3.0.0
```

### 2. å®‰è£…ä¾èµ–
```bash
pip install -r agpai/requirements.txt
```

### 3. åŸºç¡€ä½¿ç”¨
```python
# å¯¼å…¥AGPAIæ ¸å¿ƒæ¨¡å—
from agpai.core.Multi_Agent_Coordinator import MultiAgentCoordinator

# åˆå§‹åŒ–ç³»ç»Ÿ
coordinator = MultiAgentCoordinator()

# è¿è¡Œå®Œæ•´åˆ†æ
result = coordinator.run_comprehensive_analysis(
    glucose_data=glucose_values,
    timestamps=time_values,
    patient_info=patient_data
)
```

### 4. æ‰‹åŠ¨åˆ‡ç‚¹åˆ†æ
```python
# å¯¼å…¥æ‰‹åŠ¨åˆ‡ç‚¹ç³»ç»Ÿ
from agpai.core.Segmented_Brittleness_Analyzer import SegmentedBrittlenessAnalyzer
from agpai.core.Manual_Cutpoint_Manager import ManualCutpointManager

# åˆ›å»ºæ‰‹åŠ¨åˆ‡ç‚¹
manager = ManualCutpointManager()
surgery_cutpoint = manager.create_manual_cutpoint(
    timestamp='2025-07-30 08:00:00',
    cutpoint_type='PANCREATIC_SURGERY',
    description='èƒ°åäºŒæŒ‡è‚ åˆ‡é™¤æœ¯'
)

# åˆ†æ®µè„†æ€§åˆ†æ
analyzer = SegmentedBrittlenessAnalyzer()
result = analyzer.analyze_with_cutpoints(
    glucose_data=data,
    timestamps=timestamps,
    patient_info=patient_info,
    manual_cutpoints=[surgery_cutpoint]
)
```

## ğŸ“‹ ç¤ºä¾‹æ¼”ç¤º

### å®Œæ•´ç³»ç»Ÿæ¼”ç¤º
```bash
python agpai/examples/AGPAI_Complete_Enhanced_Demo.py
```

### æ‰‹åŠ¨åˆ‡ç‚¹æ¼”ç¤º
```bash
python agpai/examples/Manual_Cutpoint_Demo.py
```

### èƒ°è…ºå¤–ç§‘ä¸“é¡¹æ¼”ç¤º  
```bash
python agpai/examples/Pancreatic_Surgery_Cutpoint_Demo.py
```

## ğŸ¥ ä¸´åºŠåº”ç”¨åœºæ™¯

### èƒ°è…ºå¤–ç§‘
- **æœ¯å‰è¯„ä¼°**: åŸºçº¿è¡€ç³–è„†æ€§è¯„ä¼°
- **æœ¯åç›‘æµ‹**: æ‰‹æœ¯å¯¹è¡€ç³–ç³»ç»Ÿå½±å“è¿½è¸ª
- **æ²»ç–—è°ƒæ•´**: TPNã€èƒ°å²›ç´ æ–¹æ¡ˆä¼˜åŒ–
- **æ¢å¤è¯„ä¼°**: èƒ°è…ºåŠŸèƒ½å’Œä»£è°¢æ¢å¤ç›‘æµ‹

### å†…åˆ†æ³Œç§‘
- **è„†æ€§è¯„ä¼°**: ç³–å°¿ç—…è¡€ç³–è„†æ€§åˆ†å‹
- **è¯ç‰©è°ƒæ•´**: æ²»ç–—æ–¹æ¡ˆä¼˜åŒ–å»ºè®®
- **é£é™©é¢„è­¦**: å¹¶å‘ç—‡é£é™©è¯†åˆ«
- **æ•ˆæœè¿½è¸ª**: é•¿æœŸæ²»ç–—æ•ˆæœè¯„ä¼°

### ICU/CCU
- **é‡ç—‡ç›‘æµ‹**: å±é‡æ‚£è€…è¡€ç³–ç®¡ç†
- **åº”æ¿€è¯„ä¼°**: åº”æ¿€çŠ¶æ€è¡€ç³–æ¨¡å¼åˆ†æ
- **è¥å…»ç®¡ç†**: TPN/ENè¡€ç³–æ§åˆ¶ä¼˜åŒ–
- **é¢„åè¯„ä¼°**: è¡€ç³–ç¨³å®šæ€§ä¸é¢„åå…³ç³»

## ğŸ“Š åˆ†ææŠ¥å‘Š

### æ ‡å‡†æŠ¥å‘Šå†…å®¹
- **æ‚£è€…åŸºæœ¬ä¿¡æ¯**
- **æ•°æ®è´¨é‡è¯„ä¼°**
- **94é¡¹ä¸“ä¸šæŒ‡æ ‡**
- **è„†æ€§åˆ†å‹ç»“æœ**
- **æ··æ²Œåˆ†ææŒ‡æ ‡**
- **ä¸´åºŠå»ºè®®**
- **ä¸ªæ€§åŒ–æ²»ç–—æ–¹æ¡ˆ**

### åˆ‡ç‚¹åˆ†ææŠ¥å‘Š
- **åˆ‡ç‚¹æ£€æµ‹ç»“æœ**
- **åˆ†æ®µç‰¹å¾åˆ†æ**
- **æ²»ç–—æ•ˆæœè¯„ä¼°**
- **æ”¹å–„åº¦é‡åŒ–**
- **ä¸‹ä¸€æ­¥å»ºè®®**

## ğŸ”§ ç³»ç»Ÿé…ç½®

### é…ç½®æ–‡ä»¶
```yaml
# config/config.yaml
analysis:
  enable_chaos_analysis: true
  brittleness_confidence_threshold: 0.8
  
cutpoint_detection:
  min_segment_hours: 24
  statistical_significance: 0.01
  
output:
  report_format: ["json", "pdf"]
  visualization: true
```

### å‚æ•°è°ƒæ•´
é€šè¿‡ä¿®æ”¹ `config/` ç›®å½•ä¸‹çš„CSVå‚æ•°æ–‡ä»¶å¯è°ƒæ•´ï¼š
- è„†æ€§åˆ†å‹é˜ˆå€¼
- æ··æ²Œåˆ†æå‚æ•°
- åˆ‡ç‚¹æ£€æµ‹çµæ•åº¦
- ä¸´åºŠå»ºè®®è§„åˆ™

## ğŸš€ é«˜çº§åŠŸèƒ½

### æ‰¹é‡åˆ†æ
```python
# æ‰¹é‡å¤„ç†å¤šä¸ªæ‚£è€…
from agpai.examples.Batch_Analysis import BatchProcessor

processor = BatchProcessor()
results = processor.analyze_folder('/path/to/patient/data/')
```

### ç®—æ³•éªŒè¯
```python
# ä¸€è‡´æ€§æµ‹è¯•
from agpai.examples.Algorithm_Consistency_Test import test_consistency

test_results = test_consistency(patient_data, num_tests=5)
```

### æ•°æ®å¯¼å‡º
```python
# å¤šæ ¼å¼å¯¼å‡º
manager.export_cutpoints(cutpoints, format='timeline')  # æ—¶é—´çº¿
manager.export_cutpoints(cutpoints, format='json')      # JSON
manager.export_cutpoints(cutpoints, format='csv')       # CSV
```

## ğŸ“ˆ æŠ€æœ¯ä¼˜åŠ¿

### ç®—æ³•ç¨³å®šæ€§
- HurstæŒ‡æ•°è®¡ç®—ä¸€è‡´æ€§: 100%
- è„†æ€§åˆ†å‹é‡ç°æ€§: 99.4%
- æ‰¹é‡åˆ†ææˆåŠŸç‡: 99.4%

### ä¸´åºŠå®ç”¨æ€§  
- 12ç§ä¸“ä¸šåˆ‡ç‚¹ç±»å‹è¦†ç›–ä¸´åºŠå¸¸è§åœºæ™¯
- æ™ºèƒ½éªŒè¯æä¾›è´¨é‡æ§åˆ¶
- ä¸ªæ€§åŒ–å»ºè®®åŸºäºå¾ªè¯åŒ»å­¦æŒ‡å—

### ç³»ç»Ÿæ€§èƒ½
- å•æ‚£è€…åˆ†æ: <30ç§’
- æ‰¹é‡åˆ†æ: <5åˆ†é’Ÿ/100ä¾‹
- æ”¯æŒå¹¶å‘ç”¨æˆ·: 50+

## ğŸ¤ æŠ€æœ¯æ”¯æŒ

### æ–‡æ¡£èµ„æº
- [ç³»ç»Ÿæ¶æ„æ–‡æ¡£](docs/System_Architecture_Update.md)
- [æ‰‹åŠ¨åˆ‡ç‚¹ä½¿ç”¨æŒ‡å—](docs/Manual_Cutpoint_System_Guide.md)
- [ä¸´åºŠåº”ç”¨æŒ‡å—](docs/Clinical_Application_Guide.md)

### é—®é¢˜åé¦ˆ
- æŠ€æœ¯é—®é¢˜: æäº¤GitHub Issue
- ä¸´åºŠå’¨è¯¢: è”ç³»å¼€å‘å›¢é˜Ÿ
- åŠŸèƒ½å»ºè®®: å‚ä¸ç¤¾åŒºè®¨è®º

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰å‚ä¸AGPAIç³»ç»Ÿå¼€å‘å’ŒéªŒè¯çš„ä¸´åºŠä¸“å®¶ã€æ•°æ®ç§‘å­¦å®¶å’Œå·¥ç¨‹å¸ˆå›¢é˜Ÿã€‚

---

**AGPAI** - è®©è¡€ç³–ç®¡ç†æ›´æ™ºèƒ½ï¼Œè®©ç³–å°¿ç—…æ²»ç–—æ›´ç²¾å‡†ã€‚