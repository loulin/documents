# å­•å‘¨æœŸç‰¹å¼‚æ€§CGMè¯„ä¼°å·¥å…· - ä½¿ç”¨æŒ‡å—

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
pip install numpy pandas datetime dataclasses
```

### åŸºæœ¬ä½¿ç”¨
```python
from CGM_GDM_Final import GestationalCGMRiskAssessmentTool, PatientFactors

# åˆ›å»ºå·¥å…·å®ä¾‹
tool = GestationalCGMRiskAssessmentTool()

# è®¾ç½®æ‚£è€…ä¿¡æ¯
patient_factors = PatientFactors(
    gestational_weeks=28,     # å­•28å‘¨
    obesity=True,             # è‚¥èƒ–
    advanced_age=True,        # é«˜é¾„
    previous_gdm=False        # æ— æ—¢å¾€GDMå²
)

# æ‰§è¡Œè¯„ä¼°
result = tool.assess_patient(glucose_values, timestamps, patient_factors)

# æŸ¥çœ‹ç»“æœ
if result['success']:
    print(f"å­•æœŸé˜¶æ®µ: {result['gestational_period_cn']}")
    print(f"ç»¼åˆåˆ†å‹: {result['classification']['comprehensive_type']}")
    print(f"é£é™©ç­‰çº§: {result['risk_scores']['risk_level']}")
    print(result['report'])
```

## æ ¸å¿ƒç‰¹æ€§è¯¦è§£

### 1. å­•æœŸè‡ªåŠ¨è¯†åˆ«

å·¥å…·ä¼šæ ¹æ®å­•å‘¨è‡ªåŠ¨è¯†åˆ«å­•æœŸé˜¶æ®µï¼š

| å­•æœŸ | å­•å‘¨èŒƒå›´ | ç”Ÿç†ç‰¹ç‚¹ | è¯„ä¼°é‡ç‚¹ |
|------|----------|----------|----------|
| å­•æ—©æœŸ | <20å‘¨ | å™¨å®˜å‘ç”ŸæœŸ | é¢„é˜²èƒå„¿ç•¸å½¢ |
| å­•ä¸­æœŸ | 20-32å‘¨ | èƒ°å²›ç´ æŠµæŠ—å¼€å§‹ | é¢„é˜²å¦Šå¨ å¹¶å‘ç—‡ |
| å­•æ™šæœŸ | >32å‘¨ | èƒ°å²›ç´ æŠµæŠ—é«˜å³° | ç¡®ä¿åˆ†å¨©å®‰å…¨ |

### 2. å­•æœŸç‰¹å¼‚æ€§ç›®æ ‡èŒƒå›´

```python
# ä¸åŒå­•æœŸçš„TIRç›®æ ‡èŒƒå›´
å­•æ—©æœŸ: 3.5-7.5 mmol/L    # æ›´ä¸¥æ ¼ï¼Œé¢„é˜²ç•¸å½¢
å­•ä¸­æœŸ: 3.5-7.8 mmol/L    # å›½é™…æ ‡å‡†
å­•æ™šæœŸ: 3.9-7.8 mmol/L    # é˜²æ­¢ä½è¡€ç³–
```

### 3. åŠ¨æ€æƒé‡ç³»ç»Ÿ

```python
# æƒé‡é…ç½®éšå­•æœŸå˜åŒ–
å­•æ—©æœŸ: æ§åˆ¶40% | å˜å¼‚æ€§35% | æ€¥æ€§15% | é•¿æœŸ10%
å­•ä¸­æœŸ: æ§åˆ¶35% | å˜å¼‚æ€§30% | æ€¥æ€§25% | é•¿æœŸ10%
å­•æ™šæœŸ: æ§åˆ¶30% | å˜å¼‚æ€§25% | æ€¥æ€§35% | é•¿æœŸ10%
```

## è¯¦ç»†åŠŸèƒ½è¯´æ˜

### PatientFactors å‚æ•°è¯´æ˜

```python
@dataclass
class PatientFactors:
    gestational_weeks: float        # å­•å‘¨æ•°ï¼ˆå¿…éœ€ï¼‰
    previous_gdm: bool = False      # æ—¢å¾€GDMå²
    obesity: bool = False           # è‚¥èƒ–(BMIâ‰¥28)
    advanced_age: bool = False      # é«˜é¾„(â‰¥35å²)
    family_history: bool = False    # å®¶æ—å²
    pcos: bool = False             # å¤šå›Šåµå·¢ç»¼åˆå¾
    hypertension: bool = False     # é«˜è¡€å‹å²
```

### è¯„ä¼°ç»“æœç»“æ„

```python
{
    'success': True,                              # è¯„ä¼°æ˜¯å¦æˆåŠŸ
    'assessment_id': 'GA28W_202501091430',        # è¯„ä¼°ID
    'gestational_period': 'mid',                 # å­•æœŸé˜¶æ®µ
    'gestational_period_cn': 'å­•ä¸­æœŸ',           # å­•æœŸä¸­æ–‡åç§°
    'gestational_weeks': 28.0,                   # å­•å‘¨æ•°
    'target_glucose_range': (3.5, 7.8),          # ç›®æ ‡è¡€ç³–èŒƒå›´
    'risk_weights_used': {...},                  # ä½¿ç”¨çš„æƒé‡é…ç½®
    'metrics': {...},                            # CGMæŒ‡æ ‡
    'classification': {...},                     # è¡€ç³–åˆ†å‹
    'risk_scores': {...},                        # é£é™©è¯„åˆ†
    'management_recommendations': {...},         # ç®¡ç†å»ºè®®
    'adverse_outcome_predictions': {...},        # ä¸è‰¯äº‹ä»¶é¢„æµ‹
    'clinical_summary': {...},                   # ä¸´åºŠæ‘˜è¦
    'report': '...',                            # è¯¦ç»†æŠ¥å‘Š
    'assessment_timestamp': '2025-01-09T14:30:00' # è¯„ä¼°æ—¶é—´
}
```

## é«˜çº§åŠŸèƒ½

### æ‰¹é‡è¯„ä¼°

```python
# å‡†å¤‡æ‰¹é‡æ•°æ®
patients_data = [
    {
        'patient_id': 'P001',
        'glucose_values': [...],
        'timestamps': [...],
        'patient_factors': PatientFactors(gestational_weeks=16, obesity=True)
    },
    {
        'patient_id': 'P002', 
        'glucose_values': [...],
        'timestamps': [...],
        'patient_factors': PatientFactors(gestational_weeks=30, previous_gdm=True)
    }
]

# æ‰§è¡Œæ‰¹é‡è¯„ä¼°
results = tool.batch_assess(patients_data)

# å¤„ç†ç»“æœ
for result in results:
    if result['success']:
        print(f"æ‚£è€…{result['patient_id']}: {result['risk_scores']['risk_level']}")
```

### ç»“æœå¯¼å‡º

```python
# å¯¼å‡ºJSONæ ¼å¼
json_file = tool.export_results(result, 'json', 'patient_assessment')

# å¯¼å‡ºæ–‡æœ¬æŠ¥å‘Š
txt_file = tool.export_results(result, 'txt', 'patient_report')

# å¯¼å‡ºExcelæ ¼å¼ï¼ˆéœ€è¦pandasï¼‰
excel_file = tool.export_results(result, 'excel', 'patient_data')

# æ‰¹é‡ç»“æœå¯¼å‡º
batch_file = tool.export_results(batch_results, 'json', 'batch_assessment')
```

## ä¸´åºŠåº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå­•æ—©æœŸåˆæ¬¡è¯„ä¼°

```python
# å­•16å‘¨ï¼Œæ—¢å¾€GDMå²ï¼Œé«˜é¾„
patient = PatientFactors(
    gestational_weeks=16,
    previous_gdm=True,
    advanced_age=True
)

result = tool.assess_patient(glucose_values, timestamps, patient)

# é‡ç‚¹å…³æ³¨ï¼š
# - èƒå„¿ç•¸å½¢é£é™©
# - è¡€ç³–æ§åˆ¶ç¨³å®šæ€§
# - æ—©æœŸå¹²é¢„å¿…è¦æ€§
```

### åœºæ™¯2ï¼šå­•ä¸­æœŸè¡€ç³–æ¶åŒ–

```python
# å­•26å‘¨ï¼Œè‚¥èƒ–ï¼ŒPCOS
patient = PatientFactors(
    gestational_weeks=26,
    obesity=True,
    pcos=True
)

result = tool.assess_patient(glucose_values, timestamps, patient)

# é‡ç‚¹å…³æ³¨ï¼š
# - èƒå„¿ç”Ÿé•¿å‘è‚²
# - å¦Šå¨ å¹¶å‘ç—‡é¢„é˜²
# - æ²»ç–—æ–¹æ¡ˆè°ƒæ•´
```

### åœºæ™¯3ï¼šå­•æ™šæœŸåˆ†å¨©å‡†å¤‡

```python
# å­•36å‘¨ï¼Œå¤šé‡é£é™©å› ç´ 
patient = PatientFactors(
    gestational_weeks=36,
    previous_gdm=True,
    obesity=True,
    hypertension=True
)

result = tool.assess_patient(glucose_values, timestamps, patient)

# é‡ç‚¹å…³æ³¨ï¼š
# - åˆ†å¨©æ—¶æœºé€‰æ‹©
# - æ–°ç”Ÿå„¿å¹¶å‘ç—‡é¢„é˜²
# - äº§åç®¡ç†è®¡åˆ’
```

## åˆ†å‹è§£è¯»æŒ‡å—

### Aå‹-ç†æƒ³ç¨³å®š
- **ç‰¹å¾**ï¼šTIRâ‰¥80%, CV<25%
- **é£é™©**ï¼šæä½åˆ°ä½é£é™©
- **ç®¡ç†**ï¼šæ ‡å‡†äº§æ£€ï¼Œç»´æŒç°çŠ¶

### Bå‹-è‰¯å¥½æ§åˆ¶
- **ç‰¹å¾**ï¼šTIR 70-79%, CVç¨³å®š
- **é£é™©**ï¼šä½åˆ°ä¸­é£é™©
- **ç®¡ç†**ï¼šå®šæœŸç›‘æµ‹ï¼Œé€‚å½“è°ƒæ•´

### Cå‹-é¤åå¤±æ§
- **ç‰¹å¾**ï¼šé¤åè¡€ç³–å‡é«˜æ˜æ˜¾
- **é£é™©**ï¼šä¸­ç­‰é£é™©
- **ç®¡ç†**ï¼šé¤åè¡€ç³–ç®¡ç†ï¼Œè¥å…»æŒ‡å¯¼

### Då‹-æŒç»­é«˜è¡€ç³–
- **ç‰¹å¾**ï¼šTIR<50%, æŒç»­é«˜è¡€ç³–
- **é£é™©**ï¼šé«˜é£é™©
- **ç®¡ç†**ï¼šå¼ºåŒ–æ²»ç–—ï¼Œå¯†åˆ‡ç›‘æµ‹

### Få‹-æä¸ç¨³å®š
- **ç‰¹å¾**ï¼šCV>50%, è¡€ç³–æ³¢åŠ¨æå¤§
- **é£é™©**ï¼šæé«˜é£é™©
- **ç®¡ç†**ï¼šç´§æ€¥å¹²é¢„ï¼Œå¯èƒ½éœ€è¦ä½é™¢

## é£é™©é¢„æµ‹è§£è¯»

### ä¸è‰¯äº‹ä»¶é£é™©åˆ†çº§

| é£é™©æ°´å¹³ | æ¦‚ç‡èŒƒå›´ | ä¸´åºŠæ„ä¹‰ | ç®¡ç†ç­–ç•¥ |
|----------|----------|----------|----------|
| **ä½é£é™©** | <10% | å¸¸è§„ç®¡ç† | æ ‡å‡†äº§æ£€ |
| **ä¸­é£é™©** | 10-20% | éœ€è¦å…³æ³¨ | åŠ å¼ºç›‘æµ‹ |
| **é«˜é£é™©** | 20-40% | ç§¯æå¹²é¢„ | ä¸“ç§‘ç®¡ç† |
| **æé«˜é£é™©** | >40% | ç´§æ€¥å¤„ç† | å¤šå­¦ç§‘åä½œ |

### å­•æœŸç‰¹å¼‚æ€§é«˜é£é™©äº‹ä»¶

**å­•æ—©æœŸé‡ç‚¹ï¼š**
- èƒå„¿ç•¸å½¢é£é™©
- æµäº§é£é™©

**å­•ä¸­æœŸé‡ç‚¹ï¼š**
- å·¨å¤§å„¿é£é™©
- å¦Šå¨ é«˜è¡€å‹é£é™©

**å­•æ™šæœŸé‡ç‚¹ï¼š**
- èƒå„¿çª˜è¿«é£é™©
- æ–°ç”Ÿå„¿ä½è¡€ç³–é£é™©

## ç®¡ç†å»ºè®®è§£è¯»

### äº§æ£€é¢‘ç‡è°ƒæ•´

| é£é™©ç­‰çº§ | å­•æ—©æœŸ | å­•ä¸­æœŸ | å­•æ™šæœŸ |
|----------|--------|--------|--------|
| **ç»¿çº§** | æ ‡å‡† | æ ‡å‡† | æ ‡å‡† |
| **é»„çº§** | æ¯3å‘¨ | æ¯2å‘¨ | æ¯2å‘¨ |
| **æ©™çº§** | æ¯2å‘¨ | æ¯å‘¨ | æ¯å‘¨ |
| **çº¢çº§** | æ¯å‘¨ | ä½é™¢è¯„ä¼° | ä½é™¢ç®¡ç† |

### CGMç›‘æµ‹ç­–ç•¥

- **é—´æ­‡æ€§CGM**ï¼šæ¯å‘¨2-3å¤©ï¼Œé€‚ç”¨äºä½é£é™©
- **è¿ç»­CGM**ï¼šæŒç»­ç›‘æµ‹ï¼Œé€‚ç”¨äºä¸­ç­‰é£é™©
- **å®æ—¶CGM**ï¼šå®æ—¶é¢„è­¦ï¼Œé€‚ç”¨äºé«˜é£é™©

### ä¸“ç§‘ä¼šè¯Šå»ºè®®

- **å†…åˆ†æ³Œç§‘**ï¼šè¡€ç³–æ§åˆ¶ä¸ä½³æ—¶
- **äº§ç§‘ä¸“å®¶**ï¼šé«˜é£é™©å­•å¦‡ç®¡ç†
- **è¥å…»ç§‘**ï¼šä¸ªä½“åŒ–è¥å…»æ–¹æ¡ˆ
- **æ–°ç”Ÿå„¿ç§‘**ï¼šå­•æ™šæœŸé«˜é£é™©å‡†å¤‡

## å¸¸è§é—®é¢˜è§£ç­”

### Q1: å­•å‘¨æ•°ä¸å‡†ç¡®æ€ä¹ˆåŠï¼Ÿ
A: å»ºè®®ä½¿ç”¨æœ«æ¬¡æœˆç»æœŸç»“åˆæ—©æœŸè¶…å£°æ ¸å®å­•å‘¨ï¼Œç¡®ä¿è¯„ä¼°å‡†ç¡®æ€§ã€‚

### Q2: CGMæ•°æ®ä¸å®Œæ•´å¦‚ä½•å¤„ç†ï¼Ÿ
A: å·¥å…·è¦æ±‚è‡³å°‘70%æœ‰æ•ˆæ•°æ®ç‚¹ï¼Œæ•°æ®è´¨é‡è¿‡ä½ä¼šç»™å‡ºè­¦å‘Šæç¤ºã€‚

### Q3: ä¸åŒå­•æœŸçš„ç›®æ ‡èŒƒå›´ä¾æ®æ˜¯ä»€ä¹ˆï¼Ÿ
A: åŸºäºNICE 2015, ADA 2023, IADPSG 2010ç­‰å›½é™…æŒ‡å—çš„å­•æœŸç‰¹å¼‚æ€§å»ºè®®ã€‚

### Q4: æƒé‡è°ƒæ•´çš„ç§‘å­¦ä¾æ®ï¼Ÿ
A: åŸºäºMurphy HR (2018), Feig DS (2017), Kristensen K (2019)ç­‰å¾ªè¯åŒ»å­¦æ–‡çŒ®ã€‚

### Q5: å¦‚ä½•å¤„ç†è¯„ä¼°ç»“æœçš„ä¸´åºŠåº”ç”¨ï¼Ÿ
A: ç»“æœä»…ä¾›ä¸´åºŠå‚è€ƒï¼Œéœ€è¦ç»“åˆæ‚£è€…å…·ä½“æƒ…å†µå’Œä¸´åºŠç»éªŒè¿›è¡Œç»¼åˆåˆ¤æ–­ã€‚

## æŠ€æœ¯æ”¯æŒ

### ç³»ç»Ÿè¦æ±‚
- Python 3.7+
- numpy >= 1.19.0
- pandas >= 1.3.0 (å¯¼å‡ºExcelåŠŸèƒ½)

### æ€§èƒ½ä¼˜åŒ–
- å•æ¬¡è¯„ä¼°ï¼š<1ç§’
- æ‰¹é‡è¯„ä¼°ï¼šæ”¯æŒå¹¶å‘å¤„ç†
- å†…å­˜å ç”¨ï¼šæ¯1000ä¸ªæ•°æ®ç‚¹çº¦2MB

### é”™è¯¯å¤„ç†
å·¥å…·æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå¤„ç†å»ºè®®ï¼š

```python
if not result['success']:
    print(f"è¯„ä¼°å¤±è´¥: {result['error']}")
    print(f"é”™è¯¯ç±»å‹: {result['error_type']}")
    print(f"å»ºè®®: {result['message']}")
```

## ç‰ˆæœ¬æ›´æ–°æ—¥å¿—

### v2.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ… æ–°å¢å­•å‘¨æœŸç‰¹å¼‚æ€§è¯„ä¼°åŠŸèƒ½
- âœ… åŠ¨æ€æƒé‡è°ƒæ•´æœºåˆ¶
- âœ… æ—¶é—´çª—å£é£é™©é¢„æµ‹
- âœ… ä¸ªä½“åŒ–ç®¡ç†å»ºè®®
- âœ… æ‰¹é‡å¤„ç†å’Œç»“æœå¯¼å‡º
- âœ… å®Œæ•´çš„æ¼”ç¤ºå’Œæ–‡æ¡£

### æœªæ¥è®¡åˆ’
- ğŸ”„ ç»“åˆäººå·¥æ™ºèƒ½ä¼˜åŒ–ç®—æ³•
- ğŸ”„ å¢åŠ æ›´å¤šç”Ÿç‰©æ ‡å¿—ç‰©æ•´åˆ
- ğŸ”„ å¼€å‘Webç•Œé¢å’Œç§»åŠ¨åº”ç”¨
- ğŸ”„ å¤šä¸­å¿ƒä¸´åºŠéªŒè¯ç ”ç©¶

---

**å…è´£å£°æ˜**: æœ¬å·¥å…·ä»…ä¾›ä¸´åºŠè¾…åŠ©å†³ç­–ä½¿ç”¨ï¼Œä¸èƒ½æ›¿ä»£åŒ»ç”Ÿçš„ä¸“ä¸šåˆ¤æ–­ã€‚æ‰€æœ‰æ²»ç–—å†³ç­–åº”åŸºäºå®Œæ•´çš„ä¸´åºŠè¯„ä¼°å’Œæ‚£è€…ä¸ªä½“æƒ…å†µã€‚