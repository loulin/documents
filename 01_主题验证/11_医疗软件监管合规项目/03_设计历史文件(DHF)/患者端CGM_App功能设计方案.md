# 患者端CGM App 功能设计方案
## Patient-Facing CGM Mobile Application - Feature Design

**文档编号**: PRD-Patient-App-001
**版本**: v1.0
**日期**: 2025-10-10
**平台**: iOS (iOS 15+) / Android (Android 11+)

---

## 目录

1. [产品概述](#1-产品概述)
2. [核心功能模块](#2-核心功能模块)
3. [功能优先级](#3-功能优先级)
4. [用户旅程](#4-用户旅程)
5. [界面设计原则](#5-界面设计原则)
6. [技术实现要点](#6-技术实现要点)
7. [监管考虑](#7-监管考虑)
8. [开发路线图](#8-开发路线图)

---

## 1. 产品概述

### 1.1 产品定位
**一句话描述**: 为糖尿病患者提供实时血糖监测、智能警报和健康管理的移动应用

**核心价值**:
- 📊 实时查看CGM血糖数据
- ⚠️ 及时警报(低血糖/高血糖)
- 📈 趋势分析和洞察
- 🏥 与医生无缝协作
- 📝 全方位健康日志

### 1.2 目标用户

**主要用户**: 使用CGM的糖尿病患者
- 1型糖尿病(胰岛素依赖)
- 2型糖尿病(胰岛素治疗)
- 年龄:18-75岁
- 技术水平:能熟练使用智能手机

**用户痛点**:
- ❌ 频繁指尖采血痛苦
- ❌ 血糖波动不可见(传统测量)
- ❌ 低血糖警报不及时
- ❌ 数据分散,难以分析
- ❌ 与医生沟通不便

---

## 2. 核心功能模块

### 📱 模块架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    患者端CGM App架构                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块1: 实时血糖监测 (Real-Time Glucose)           │   │
│  │  - 当前血糖值显示                                  │   │
│  │  - 趋势箭头(↑↗→↘↓)                               │   │
│  │  - 实时曲线图(最近3/6/12/24小时)                  │   │
│  │  - 刷新频率:1-5分钟                               │   │
│  └────────────────────────────────────────────────────┘   │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块2: 智能警报系统 (Smart Alerts)               │   │
│  │  - 低血糖警报(<70 mg/dL)                          │   │
│  │  - 高血糖警报(>180 mg/dL)                         │   │
│  │  - 快速下降/上升警报                              │   │
│  │  - 用户自定义阈值                                 │   │
│  │  - 警报历史记录                                   │   │
│  └────────────────────────────────────────────────────┘   │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块3: 数据分析与报告 (Analytics)                │   │
│  │  - AGP报告(Ambulatory Glucose Profile)           │   │
│  │  - 目标范围内时间(TIR)                            │   │
│  │  - 血糖变异系数(CV)                               │   │
│  │  - 低血糖/高血糖事件统计                          │   │
│  │  - 周/月报告                                      │   │
│  └────────────────────────────────────────────────────┘   │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块4: 健康日志 (Health Logging)                 │   │
│  │  - 饮食记录(碳水化合物)                           │   │
│  │  - 运动记录(类型、时长、强度)                     │   │
│  │  - 用药记录(胰岛素、口服药)                       │   │
│  │  - 症状记录(低血糖症状)                           │   │
│  │  - 照片记录(餐食照片)                             │   │
│  └────────────────────────────────────────────────────┘   │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块5: 医患协作 (Care Team)                      │   │
│  │  - 数据共享(授权医生查看)                         │   │
│  │  - 安全消息传递                                   │   │
│  │  - 医生备注查看                                   │   │
│  │  - 预约提醒                                       │   │
│  └────────────────────────────────────────────────────┘   │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块6: 教育与洞察 (Education & Insights)         │   │
│  │  - 糖尿病知识库                                   │   │
│  │  - 个性化健康建议                                 │   │
│  │  - 趋势洞察("您的晚餐后血糖经常偏高")             │   │
│  │  - 成就系统(连续X天目标达成)                      │   │
│  └────────────────────────────────────────────────────┘   │
│  ┌────────────────────────────────────────────────────┐   │
│  │  模块7: 设置与管理 (Settings)                     │   │
│  │  - 个人资料(身高、体重、HbA1c目标)                │   │
│  │  - 警报设置(阈值、声音、振动)                     │   │
│  │  - 传感器管理(配对、校准、更换)                   │   │
│  │  - 数据导出(PDF/CSV)                              │   │
│  │  - 隐私设置                                       │   │
│  └────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 模块1: 实时血糖监测 (MVP核心)

### 功能1.1: 仪表盘(Dashboard)

**界面布局**:
```
┌─────────────────────────────────────┐
│  ☰  CGM App              🔔 ⚙️      │ <- 顶部导航
├─────────────────────────────────────┤
│                                     │
│        当前血糖                      │
│         128 ↗                       │ <- 大字体显示
│        mg/dL                        │    趋势箭头
│                                     │
│   🟢 目标范围内                      │ <- 状态指示
│   更新于 2分钟前                     │
│                                     │
├─────────────────────────────────────┤
│  📊 血糖曲线 (最近6小时)             │
│                                     │
│  200┼─╮                             │
│     │  ╰╮   ╭─╮                     │
│  100┼────╰─╯───╰─ [目标范围]       │ <- 交互式图表
│     │                               │
│   50┼                               │
│     0h  3h  6h                      │
│                                     │
│  [3h] [6h] [12h] [24h]              │ <- 时间段选择
├─────────────────────────────────────┤
│  📋 快捷操作                         │
│  ┌──────┐ ┌──────┐ ┌──────┐        │
│  │ 🍽️ 餐 │ │ 💊 药 │ │ 🏃运动│        │ <- 快捷记录
│  │  食   │ │  物   │ │      │        │
│  └──────┘ └──────┘ └──────┘        │
├─────────────────────────────────────┤
│  💡 今日洞察                         │
│  "您今天的目标范围内时间为78%,      │ <- AI洞察
│   比昨天提高了5%,做得很好!"          │
└─────────────────────────────────────┘
```

**功能细节**:

| 功能项 | 描述 | 技术要点 | 监管考虑 |
|-------|------|---------|---------|
| **当前血糖值** | - 大字体显示(易读)<br>- 单位:mg/dL或mmol/L(可切换)<br>- 颜色编码:绿(正常)、黄(偏高/低)、红(危险) | - 从CGM API实时拉取<br>- 本地缓存最后已知值<br>- 异常值验证(20-600 mg/dL) | ⚠️ 必须准确显示<br>⚠️ 数据延迟>5分钟需警告 |
| **趋势箭头** | - ↑ 快速上升(>2 mg/dL/min)<br>- ↗ 上升(1-2 mg/dL/min)<br>- → 平稳(<1 mg/dL/min)<br>- ↘ 下降(1-2 mg/dL/min)<br>- ↓ 快速下降(>2 mg/dL/min) | - 基于最近15分钟数据计算<br>- 与CGM接收器一致 | ⚠️ 趋势错误高风险<br>⚠️ 必须验证准确性 |
| **更新时间** | - "更新于X分钟前"<br>- 超过15分钟显示警告 | - 时间戳比对 | ⚠️ 延迟警告必需 |
| **血糖曲线图** | - 交互式折线图<br>- 目标范围阴影(70-180 mg/dL)<br>- 可缩放、滚动<br>- 点击数据点查看详情 | - 使用Chart.js/Victory<br>- 本地数据库缓存7-14天 | ⚠️ 图表准确性验证 |
| **时间段切换** | - 3小时(运动后快速查看)<br>- 6小时(日常监测)<br>- 12小时(隔夜监测)<br>- 24小时(全天回顾) | - 前端数据筛选 | - |

---

### 功能1.2: 血糖详情页

**触发**: 点击当前血糖值或曲线图上的数据点

**界面**:
```
┌─────────────────────────────────────┐
│  ← 血糖详情              分享 ⋮     │
├─────────────────────────────────────┤
│  2025-10-10 14:32                   │
│                                     │
│        128 mg/dL ↗                  │
│                                     │
│  状态: 🟢 目标范围内                 │
│  (目标: 70-180 mg/dL)               │
│                                     │
├─────────────────────────────────────┤
│  📊 趋势分析                         │
│  - 过去15分钟: 上升 6 mg/dL         │
│  - 预测30分钟后: 约 140 mg/dL       │ <- 可选功能
│                                     │
├─────────────────────────────────────┤
│  📝 关联记录                         │
│  🍽️ 午餐后 2小时                    │
│     - 碳水: 60g (面条)              │
│  💊 胰岛素: 餐前8单位                │
│                                     │
├─────────────────────────────────────┤
│  ➕ 添加备注                         │
│  "感觉有点头晕..."                  │
└─────────────────────────────────────┘
```

**功能细节**:
- 时间戳精确到分钟
- 显示与目标范围的关系
- 可选:简单预测(基于趋势,不作为治疗建议)
- 关联该时间段的饮食、用药、运动记录
- 用户可添加文字或语音备注

---

## 模块2: 智能警报系统 (MVP核心,安全关键!)

### 功能2.1: 警报类型

| 警报类型 | 触发条件 | 默认阈值 | 可定制 | 优先级 |
|---------|---------|---------|-------|--------|
| **紧急低血糖** | 血糖 < 55 mg/dL | 55 mg/dL | ✅ | 🔴 Critical |
| **低血糖** | 血糖 < 70 mg/dL | 70 mg/dL | ✅ | 🟠 High |
| **即将低血糖** | 血糖 < 80 mg/dL 且快速下降(↓) | 80 mg/dL + ↓ | ✅ | 🟡 Medium |
| **高血糖** | 血糖 > 180 mg/dL | 180 mg/dL | ✅ | 🟡 Medium |
| **紧急高血糖** | 血糖 > 250 mg/dL | 250 mg/dL | ✅ | 🟠 High |
| **快速上升** | 上升速率 > 3 mg/dL/min | 3 mg/dL/min | ✅ | 🟡 Medium |
| **快速下降** | 下降速率 > 3 mg/dL/min | 3 mg/dL/min | ✅ | 🟠 High |
| **传感器失效** | CGM数据超过20分钟未更新 | 20分钟 | ❌ | 🟠 High |
| **传感器即将到期** | 传感器剩余 < 12小时 | 12小时 | ✅ | 🟢 Low |

---

### 功能2.2: 警报界面

**全屏警报(Critical级别)**:
```
┌─────────────────────────────────────┐
│                                     │
│         ⚠️ 紧急低血糖                │
│                                     │
│           52 mg/dL ↓                │
│                                     │
│    请立即摄入15g快速碳水化合物        │
│    (如:3-4颗葡萄糖片、果汁)          │
│                                     │
│   ┌─────────────────────────────┐  │
│   │      我已处理                │  │ <- 必须用户确认
│   └─────────────────────────────┘  │
│                                     │
│   [通知紧急联系人]                   │ <- 可选
│                                     │
└─────────────────────────────────────┘
```

**通知栏警报(其他级别)**:
```
┌─────────────────────────────────────┐
│  🔔 CGM App                2分钟前   │
│  ⚠️ 低血糖警报                       │
│  当前血糖: 65 mg/dL ↓               │
│  点击查看详情                        │
└─────────────────────────────────────┘
```

**技术实现要点**:

| 功能 | iOS实现 | Android实现 | 监管要求 |
|------|---------|------------|---------|
| **系统级通知** | UNUserNotificationCenter | NotificationManager | ✅ 必需(不依赖应用前台) |
| **声音** | 自定义警报音 | 自定义警报音 | ✅ 可区分不同警报类型 |
| **振动** | HapticFeedback | Vibrator | ✅ 可配置 |
| **优先级** | criticalAlert权限 | HIGH_PRIORITY channel | ✅ Critical警报突破免打扰 |
| **持续警报** | 每5分钟重复(直到用户确认) | 每5分钟重复 | ✅ 防止警报疲劳 |
| **离线警报** | 本地逻辑判断 | 本地逻辑判断 | ✅ 不依赖网络 |

⚠️ **监管关键**:
- 警报灵敏度 > 99% (低血糖必须检出)
- 虚假警报率 < 5%
- 警报延迟 < 2分钟(从CGM检测到通知触发)

---

### 功能2.3: 警报设置

**界面**:
```
┌─────────────────────────────────────┐
│  ← 警报设置                          │
├─────────────────────────────────────┤
│  📣 警报开关                         │
│  ○ 全部启用  ○ 全部关闭  ○ 自定义  │
│                                     │
├─────────────────────────────────────┤
│  🔴 紧急低血糖                       │
│  ────────●─────── 55 mg/dL          │ <- 滑块
│  声音: 🔊 高音警报                   │
│  振动: ✅ 开启                       │
│  ✅ 突破免打扰模式                   │
│                                     │
├─────────────────────────────────────┤
│  🟠 低血糖                           │
│  ────────●─────── 70 mg/dL          │
│  声音: 🔊 标准警报                   │
│  振动: ✅ 开启                       │
│  ⏰ 暂停(1小时后恢复)                │ <- 防疲劳
│                                     │
├─────────────────────────────────────┤
│  🟡 高血糖                           │
│  ──────────●───── 180 mg/dL         │
│  声音: 🔔 轻柔提示                   │
│  振动: ❌ 关闭                       │
│                                     │
├─────────────────────────────────────┤
│  🌙 睡眠模式 (22:00 - 07:00)        │
│  ✅ 仅紧急低血糖警报                 │
│  ✅ 降低音量                         │
│                                     │
├─────────────────────────────────────┤
│  👥 紧急联系人                       │
│  张三 (妻子) 135****8888            │
│  [添加联系人]                        │
│  ✅ 紧急低血糖时自动通知              │
└─────────────────────────────────────┘
```

**功能细节**:
- 每个警报类型独立设置
- 阈值可调(带安全限制,如低血糖不能低于40 mg/dL)
- 声音/振动/免打扰突破独立开关
- 睡眠模式(自动降低非紧急警报)
- 警报暂停(防止警报疲劳,1-4小时)
- 紧急联系人自动通知(SMS/电话)

---

### 功能2.4: 警报历史

**界面**:
```
┌─────────────────────────────────────┐
│  ← 警报历史        [筛选] [导出]     │
├─────────────────────────────────────┤
│  今天 (5次)                          │
│                                     │
│  14:32  🟠 低血糖                    │
│         65 mg/dL ↓                  │
│         已处理 (摄入果汁)             │
│                                     │
│  11:45  🟡 高血糖                    │
│         195 mg/dL ↑                 │
│         已忽略                       │
│                                     │
├─────────────────────────────────────┤
│  昨天 (3次)                          │
│  ...                                │
│                                     │
├─────────────────────────────────────┤
│  📊 本周统计                         │
│  - 总警报: 28次                      │
│  - 低血糖: 12次 (43%)               │
│  - 高血糖: 14次 (50%)               │
│  - 虚假警报: 2次 (7%)               │ <- 用户标记
└─────────────────────────────────────┘
```

**功能**:
- 警报时间、类型、血糖值、趋势
- 用户处理记录("已处理"/"已忽略")
- 虚假警报标记(用于改进算法)
- 统计分析(警报频率、分布)
- 导出PDF(给医生查看)

---

## 模块3: 数据分析与报告

### 功能3.1: AGP报告 (Ambulatory Glucose Profile)

**AGP是什么?**
- 国际标准的血糖分析报告
- 将多天数据叠加,显示血糖模式
- 医生诊疗的重要参考

**界面**:
```
┌─────────────────────────────────────┐
│  ← AGP报告 (过去14天)                │
│                  [分享给医生] [PDF]  │
├─────────────────────────────────────┤
│  📊 关键指标                         │
│  ┌───────────┬───────────┬─────────┐│
│  │ TIR (目标  │    78%    │ 目标>70%││
│  │  范围内)   │           │         ││
│  ├───────────┼───────────┼─────────┤│
│  │ TAR (高于  │    15%    │ 目标<25%││
│  │  目标)     │           │         ││
│  ├───────────┼───────────┼─────────┤│
│  │ TBR (低于  │     7%    │ 目标<4% ││
│  │  目标)     │           │         ││
│  ├───────────┼───────────┼─────────┤│
│  │ GMI (血糖  │    7.2%   │ 目标<7% ││
│  │  管理指标) │           │         ││
│  └───────────┴───────────┴─────────┘│
│                                     │
├─────────────────────────────────────┤
│  📈 AGP曲线图                        │
│  (14天数据叠加到24小时模式)          │
│                                     │
│  300┼                               │
│     │     ╭─────95%百分位            │
│  200┼────╱      ╲────               │
│     │   ╱  [75%] ╲                  │
│  100┼──●═══[中位数]═══●── [目标范围]│
│     │   ╲  [25%] ╱                  │
│   50┼────╲      ╱────5%百分位       │
│     │     ╰─────                    │
│     0h   6h   12h  18h  24h         │
│                                     │
│  💡 洞察:                            │
│  - 凌晨2-4点经常偏低(夜间低血糖风险) │
│  - 晚餐后血糖峰值偏高                │
└─────────────────────────────────────┘
```

**技术要点**:
- 使用国际糖尿病中心(IDC)的AGP算法
- 需至少10天数据(有效数据>70%)
- 百分位数计算(5%, 25%, 50%, 75%, 95%)
- TIR/TAR/TBR/GMI自动计算

---

### 功能3.2: 日报告/周报告

**日报告**:
```
┌─────────────────────────────────────┐
│  📅 2025-10-10 (今天)                │
├─────────────────────────────────────┤
│  🎯 目标达成度: 82%                  │
│  ⭐⭐⭐⭐☆                            │
│                                     │
│  📊 血糖统计                         │
│  平均值: 135 mg/dL                  │
│  最高:   205 mg/dL (14:30 午餐后)   │
│  最低:   68 mg/dL  (23:15 夜间)     │
│  标准差: 42 mg/dL                   │
│                                     │
│  ⏱️ 时间分布                         │
│  🟢 目标范围内: 78% (18.7小时)      │
│  🟡 高于目标:   18% (4.3小时)       │
│  🔴 低于目标:   4%  (1.0小时)       │
│                                     │
│  📝 活动记录                         │
│  🍽️ 3餐 (碳水:180g)                 │
│  💊 胰岛素:26单位 (基础+餐时)        │
│  🏃 运动:30分钟快走                  │
│                                     │
│  ⚠️ 警报                             │
│  低血糖: 2次                         │
│  高血糖: 3次                         │
└─────────────────────────────────────┘
```

**周报告**:
- 7天趋势图
- 平均TIR/TAR/TBR
- 低血糖事件频率(目标:<1次/周)
- 血糖变异系数(CV,目标:<36%)
- 与上周对比("本周TIR提高5%")

---

### 功能3.3: 趋势洞察 (AI增强,可选)

**示例洞察**:
```
💡 您的血糖模式分析:

1. 晚餐后血糖峰值
   - 过去7天,晚餐后2小时血糖平均215 mg/dL
   - 高于目标180 mg/dL
   - 建议:考虑增加餐前胰岛素剂量或减少晚餐碳水

2. 夜间低血糖风险
   - 3次凌晨2-4点低血糖(<70 mg/dL)
   - 建议:睡前加餐或调整基础胰岛素

3. 运动效果
   - 运动后血糖平均下降35 mg/dL
   - 建议:运动前检查血糖,如<100 mg/dL先补充碳水
```

**技术**:
- 基于规则的模式识别(不涉及复杂AI,降低监管风险)
- 或使用简单机器学习(需额外验证)

⚠️ **监管注意**: 任何治疗建议必须有免责声明

---

## 模块4: 健康日志

### 功能4.1: 饮食记录

**快捷录入**:
```
┌─────────────────────────────────────┐
│  ← 饮食记录              ✓ 保存     │
├─────────────────────────────────────┤
│  🍽️ 餐次                             │
│  ○ 早餐  ●中餐  ○ 晚餐  ○ 加餐     │
│                                     │
│  时间: [14:30] ▼                    │
│                                     │
├─────────────────────────────────────┤
│  📸 拍照记录                         │
│  ┌─────┐ ┌─────┐ ┌─────┐           │
│  │照片1│ │照片2│ │ ＋ │            │
│  └─────┘ └─────┘ └─────┘           │
│                                     │
├─────────────────────────────────────┤
│  🍚 碳水化合物                       │
│  ────────●─────── 60g               │ <- 滑块
│                                     │
│  或搜索食物:                         │
│  [🔍 搜索食物数据库]                 │
│  - 米饭 (1碗) → 50g                 │
│  - 苹果 (1个) → 15g                 │
│                                     │
├─────────────────────────────────────┤
│  📝 备注                             │
│  "公司聚餐,不太确定碳水..."          │
└─────────────────────────────────────┘
```

**功能**:
- 照片记录(可选OCR识别食物)
- 碳水化合物估算(滑块或食物数据库)
- 餐次自动识别(基于时间)
- 与血糖曲线关联显示

---

### 功能4.2: 运动记录

**界面**:
```
┌─────────────────────────────────────┐
│  ← 运动记录              ✓ 保存     │
├─────────────────────────────────────┤
│  🏃 运动类型                         │
│  ● 快走  ○ 跑步  ○ 游泳  ○ 自行车  │
│  ○ 瑜伽  ○ 其他: [____]             │
│                                     │
│  ⏱️ 时长                             │
│  [30] 分钟                          │
│                                     │
│  💪 强度                             │
│  ○ 轻度  ● 中度  ○ 高强度           │
│                                     │
│  ⏰ 时间                             │
│  开始: [16:00] 结束: [16:30]        │
│                                     │
│  🍬 运动前血糖                       │
│  [120] mg/dL                        │
│  运动后血糖                          │
│  [85] mg/dL (下降35 mg/dL)          │
│                                     │
│  ✅ 集成Apple Health / Google Fit   │
│     自动同步运动数据                 │
└─────────────────────────────────────┘
```

**功能**:
- 运动类型、时长、强度
- 运动前后血糖对比
- 与Apple Health/Google Fit集成
- 在血糖曲线上标注运动时段

---

### 功能4.3: 用药记录

**界面**:
```
┌─────────────────────────────────────┐
│  ← 用药记录              ✓ 保存     │
├─────────────────────────────────────┤
│  💉 胰岛素                           │
│                                     │
│  类型:                              │
│  ● 速效 (Novorapid)                 │
│  ○ 长效 (Lantus)                    │
│  ○ 预混                             │
│                                     │
│  剂量: [8] 单位                      │
│                                     │
│  注射部位:                           │
│  ○ 腹部  ● 上臂  ○ 大腿            │
│                                     │
│  时间: [13:00] (午餐前)             │
│                                     │
├─────────────────────────────────────┤
│  💊 口服药物                         │
│  [+ 添加药物]                        │
│  - 二甲双胍 500mg (早/晚)           │
│                                     │
├─────────────────────────────────────┤
│  ⏰ 用药提醒                         │
│  ✅ 每日13:00提醒                    │
└─────────────────────────────────────┘
```

**功能**:
- 胰岛素记录(类型、剂量、部位、时间)
- 口服药物记录
- 用药提醒(可与手机日历同步)
- 在血糖曲线上标注用药时间

⚠️ **监管注意**:
- 不提供剂量建议(高风险功能)
- 仅记录和提醒

---

### 功能4.4: 症状记录

**界面**:
```
┌─────────────────────────────────────┐
│  ← 症状记录              ✓ 保存     │
├─────────────────────────────────────┤
│  ⚠️ 低血糖症状                       │
│  ☑ 出汗      ☑ 心跳加快             │
│  ☑ 颤抖      ☐ 视力模糊             │
│  ☑ 饥饿感    ☐ 头痛                 │
│  ☐ 意识模糊  ☐ 其他: [____]         │
│                                     │
│  🩺 其他症状                         │
│  ☐ 尿频      ☐ 口渴                 │
│  ☐ 疲劳      ☐ 恶心                 │
│                                     │
│  📝 备注                             │
│  "运动后15分钟开始出汗..."          │
│                                     │
│  ⏰ 时间: [现在] 14:45               │
└─────────────────────────────────────┘
```

**功能**:
- 低血糖症状清单(快速勾选)
- 其他症状记录
- 与血糖数据关联(帮助识别低血糖感知)
- 给医生提供参考

---

## 模块5: 医患协作

### 功能5.1: 授权医生查看

**界面**:
```
┌─────────────────────────────────────┐
│  ← 我的医疗团队          ＋ 添加    │
├─────────────────────────────────────┤
│  👨‍⚕️ 李医生 (内分泌科)              │
│     XX医院                          │
│     已授权查看:                      │
│     ✅ 血糖数据 (实时)               │
│     ✅ AGP报告                       │
│     ✅ 健康日志                      │
│     ❌ 个人身份信息 (隐藏)           │
│                                     │
│     [修改权限] [取消授权]            │
│                                     │
├─────────────────────────────────────┤
│  👩‍⚕️ 张护士 (糖尿病教育)            │
│     已授权查看:                      │
│     ✅ 血糖数据                      │
│     ❌ 健康日志 (未授权)             │
│                                     │
│     [修改权限] [取消授权]            │
└─────────────────────────────────────┘
```

**授权流程**:
1. 医生在医师端系统生成邀请码
2. 患者输入邀请码或扫描二维码
3. 患者选择授权内容和时长
4. 医生可在医师端查看

**隐私保护**:
- 细粒度权限(可仅授权血糖数据,不授权日志)
- 时间限制(如授权3个月)
- 随时可撤销
- 审计日志(谁在何时查看了数据)

---

### 功能5.2: 安全消息

**界面**:
```
┌─────────────────────────────────────┐
│  ← 与李医生对话          📎 ⋮      │
├─────────────────────────────────────┤
│                                     │
│  李医生 10-09 15:30                 │
│  ┌─────────────────────────────┐   │
│  │ 您最近的夜间血糖控制不错,   │   │
│  │ 继续保持!                   │   │
│  │ [查看关联的AGP报告]         │   │
│  └─────────────────────────────┘   │
│                                     │
│              您 10-09 16:00         │
│           ┌────────────────────┐   │
│           │ 谢谢医生!但我发现  │   │
│           │ 晚餐后血糖还是偏高 │   │
│           │ [查看血糖曲线]     │   │
│           └────────────────────┘   │
│                                     │
│  李医生 10-09 16:15                 │
│  ┌─────────────────────────────┐   │
│  │ 建议您下次复诊时我们讨论    │   │
│  │ 调整餐时胰岛素剂量          │   │
│  └─────────────────────────────┘   │
│                                     │
├─────────────────────────────────────┤
│  [输入消息...]        📷 📊 [发送]  │ <- 可附件血糖曲线/照片
└─────────────────────────────────────┘
```

**功能**:
- 加密消息传递
- 可附件血糖曲线、AGP报告、照片
- 医生可回复并关联具体数据
- 消息推送通知

⚠️ **监管注意**:
- 必须符合GDPR/HIPAA
- 端到端加密(E2EE)
- 不用于紧急情况(IFU明确说明)

---

### 功能5.3: 预约与提醒

**界面**:
```
┌─────────────────────────────────────┐
│  📅 即将到来的预约                   │
├─────────────────────────────────────┤
│  👨‍⚕️ 李医生复诊                      │
│     2025-10-15 (周二) 14:00         │
│     XX医院 内分泌科 3楼             │
│                                     │
│     准备事项:                        │
│     ☑ 空腹(检查HbA1c)               │
│     ☑ 携带血糖仪和传感器             │
│                                     │
│     [添加到日历] [导航]              │
│                                     │
│     自动生成就诊报告:               │
│     ✅ 过去3个月AGP报告              │
│     ✅ 低血糖事件汇总                │
│     [预览PDF]                       │
└─────────────────────────────────────┘
```

**功能**:
- 预约信息同步(从医师端)
- 提前提醒(1天、1小时)
- 自动生成就诊报告(给医生参考)
- 导航到医院

---

## 模块6: 教育与洞察

### 功能6.1: 糖尿病知识库

**界面**:
```
┌─────────────────────────────────────┐
│  🎓 糖尿病学院        🔍 搜索       │
├─────────────────────────────────────┤
│  📚 推荐课程                         │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 📖 如何识别低血糖?           │   │
│  │    5分钟视频 | 已学:60%     │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 📖 餐后血糖为什么会升高?     │   │
│  │    图文教程 | 未开始        │   │
│  └─────────────────────────────┘   │
│                                     │
├─────────────────────────────────────┤
│  📂 主题分类                         │
│  - 🩺 疾病基础知识                   │
│  - 🍽️ 饮食管理                       │
│  - 💉 胰岛素使用                     │
│  - 🏃 运动与血糖                     │
│  - ⚠️ 并发症预防                     │
│  - 🧘 心理健康                       │
│                                     │
├─────────────────────────────────────┤
│  ❓ 常见问题(FAQ)                    │
│  - 传感器佩戴疼吗?                   │
│  - 洗澡时需要摘下传感器吗?           │
│  - 为什么CGM和血糖仪读数不一样?      │
└─────────────────────────────────────┘
```

**内容来源**:
- 内置教育内容(文字+视频+动画)
- 链接到权威资源(ADA/IDF官网)
- 定期更新

---

### 功能6.2: 个性化健康建议

**示例**:
```
┌─────────────────────────────────────┐
│  💡 今日健康建议                     │
├─────────────────────────────────────┤
│  基于您的血糖模式:                   │
│                                     │
│  1️⃣ 晚餐后散步15分钟                 │
│     您的数据显示,餐后轻度运动可帮助  │
│     血糖下降平均25 mg/dL            │
│                                     │
│  2️⃣ 睡前血糖检查                     │
│     本周3次夜间低血糖,建议睡前确保   │
│     血糖>120 mg/dL                  │
│                                     │
│  3️⃣ 多喝水                           │
│     您今天的平均血糖偏高(160 mg/dL), │
│     多喝水有助于代谢                 │
│                                     │
│  ⚠️ 以上建议仅供参考,不替代医疗建议  │
└─────────────────────────────────────┘
```

**技术**:
- 基于规则引擎(非AI)
- 触发条件:血糖模式+行为数据
- 通用性建议(非治疗决策)

⚠️ **监管注意**:
- 必须有免责声明
- 避免具体剂量建议
- 定位为"教育性建议"

---

### 功能6.3: 成就系统

**界面**:
```
┌─────────────────────────────────────┐
│  🏆 我的成就                         │
├─────────────────────────────────────┤
│  🔥 连续打卡                         │
│     ■■■■■■■ 7天                    │
│     连续7天记录血糖!                 │
│                                     │
│  🎯 目标达成者                       │
│     ⭐⭐⭐⭐⭐                        │
│     本周TIR>70%达标5天!              │
│                                     │
│  📚 学习之星                         │
│     🥉 铜章                          │
│     完成5门课程学习                  │
│                                     │
│  🌟 待解锁成就                       │
│     □ 连续30天打卡 (进度:7/30)      │
│     □ 零低血糖周 (本周:2次)         │
│     □ 数据分享(邀请医生加入)         │
└─────────────────────────────────────┘
```

**目的**:
- 提高用户参与度
- 游戏化激励
- 培养健康习惯

---

## 模块7: 设置与管理

### 功能7.1: 个人资料

```
┌─────────────────────────────────────┐
│  ← 个人资料              ✏️ 编辑    │
├─────────────────────────────────────┤
│  👤 基本信息                         │
│  姓名: 张三                         │
│  性别: 男                           │
│  出生日期: 1985-05-20 (40岁)       │
│  身高: 175 cm                       │
│  体重: 75 kg                        │
│  BMI: 24.5 (正常)                   │
│                                     │
├─────────────────────────────────────┤
│  🩺 医疗信息                         │
│  糖尿病类型: 2型                     │
│  确诊日期: 2020-03                  │
│  治疗方案: 胰岛素+口服药             │
│                                     │
│  最近HbA1c: 7.2% (2025-09)          │
│  目标HbA1c: <7.0%                   │
│                                     │
│  血糖目标范围:                       │
│  - 空腹: 80-130 mg/dL               │
│  - 餐后2h: <180 mg/dL               │
│                                     │
├─────────────────────────────────────┤
│  💉 胰岛素方案                       │
│  基础胰岛素: Lantus 20单位(睡前)    │
│  餐时胰岛素: Novorapid (碳水比1:10) │
└─────────────────────────────────────┘
```

---

### 功能7.2: 传感器管理

```
┌─────────────────────────────────────┐
│  ← 传感器管理                        │
├─────────────────────────────────────┤
│  📡 当前传感器                       │
│  状态: ✅ 正常运行                   │
│  佩戴日期: 2025-10-08              │
│  剩余时间: 3天12小时 (共14天)       │
│                                     │
│  信号强度: ▰▰▰▱ 良好                │
│  最后更新: 2分钟前                  │
│                                     │
│  [更换传感器]                        │
│                                     │
├─────────────────────────────────────┤
│  🔗 配对新传感器                     │
│  1. 扫描传感器序列号或输入           │
│     [扫描条形码]                     │
│     或输入: [__________]             │
│                                     │
│  2. 激活传感器                       │
│     (需等待2小时预热)               │
│                                     │
│  3. 校准(如需要)                     │
│     使用血糖仪测量对比               │
│                                     │
├─────────────────────────────────────┤
│  📊 传感器历史                       │
│  - 2025-10-08 至今 (3天)            │
│  - 2025-09-24 - 10-07 (14天)       │
│  - 2025-09-10 - 09-23 (14天)       │
│    [查看数据]                        │
└─────────────────────────────────────┘
```

---

### 功能7.3: 数据导出

```
┌─────────────────────────────────────┐
│  ← 数据导出                          │
├─────────────────────────────────────┤
│  📄 导出为PDF报告                    │
│                                     │
│  时间范围:                           │
│  ○ 最近7天                          │
│  ● 最近30天                         │
│  ○ 最近90天                         │
│  ○ 自定义: [____] - [____]          │
│                                     │
│  包含内容:                           │
│  ☑ AGP报告                          │
│  ☑ 血糖曲线图                        │
│  ☑ 统计摘要                          │
│  ☑ 警报事件                          │
│  ☑ 健康日志                          │
│                                     │
│  [生成PDF] [邮件发送] [打印]         │
│                                     │
├─────────────────────────────────────┤
│  📊 导出为CSV数据                    │
│  (适用于导入其他软件或研究)          │
│                                     │
│  数据字段:                           │
│  ☑ 时间戳                            │
│  ☑ 血糖值                            │
│  ☑ 趋势                              │
│  ☑ 事件标记(餐食/运动/用药)          │
│                                     │
│  [下载CSV]                          │
└─────────────────────────────────────┘
```

---

### 功能7.4: 隐私与安全

```
┌─────────────────────────────────────┐
│  ← 隐私与安全                        │
├─────────────────────────────────────┤
│  🔐 账户安全                         │
│  ✅ Face ID / 指纹解锁               │
│  ✅ 多因素认证(MFA)                  │
│  [修改密码]                          │
│  [查看登录历史]                      │
│                                     │
├─────────────────────────────────────┤
│  🛡️ 数据隐私                         │
│  ✅ 数据本地加密存储                 │
│  ✅ 传输加密(TLS 1.3)                │
│                                     │
│  数据共享控制:                       │
│  ○ 与Apple Health同步血糖数据       │
│  ○ 用于改进产品(匿名化统计)          │
│                                     │
│  [查看隐私政策]                      │
│  [查看数据使用说明]                  │
│                                     │
├─────────────────────────────────────┤
│  ♿ 辅助功能                          │
│  ○ 大字体模式                        │
│  ○ 高对比度                          │
│  ○ 屏幕阅读器优化                    │
│  ○ 色盲友好模式                      │
│                                     │
├─────────────────────────────────────┤
│  ⚙️ 其他设置                         │
│  单位: ● mg/dL  ○ mmol/L            │
│  语言: 简体中文 ▼                   │
│  时区: Asia/Shanghai ▼              │
│                                     │
│  [关于我们]                          │
│  [帮助中心]                          │
│  [联系客服]                          │
│  [注销账户]                          │
└─────────────────────────────────────┘
```

---

## 3. 功能优先级

### MVP (Minimum Viable Product) - Phase 1 (3-4个月)

**必须有的功能**(CE认证核心):

| 优先级 | 模块 | 功能 | 原因 |
|-------|------|------|------|
| 🔴 P0 | 实时监测 | 当前血糖值显示+趋势箭头 | 核心功能 |
| 🔴 P0 | 实时监测 | 血糖曲线图(3/6/12/24h) | 核心功能 |
| 🔴 P0 | 智能警报 | 低血糖/高血糖警报 | 安全关键 |
| 🔴 P0 | 智能警报 | 警报设置(阈值、声音) | 可用性 |
| 🔴 P0 | 传感器 | 传感器配对和状态显示 | 基础功能 |
| 🔴 P0 | 设置 | 个人资料和目标设置 | 基础功能 |
| 🔴 P0 | 设置 | 账户安全(登录、MFA) | 安全要求 |
| 🟠 P1 | 数据分析 | AGP报告 | 医生诊疗参考 |
| 🟠 P1 | 数据分析 | TIR统计 | 关键指标 |
| 🟠 P1 | 健康日志 | 饮食记录(碳水) | 数据关联 |
| 🟠 P1 | 健康日志 | 用药记录(胰岛素) | 数据关联 |
| 🟠 P1 | 医患协作 | 数据共享授权 | 核心价值 |

**MVP功能列表**(12项):
- ✅ 实时血糖显示
- ✅ 趋势箭头
- ✅ 血糖曲线图
- ✅ 低/高血糖警报
- ✅ 警报设置
- ✅ AGP报告
- ✅ TIR统计
- ✅ 饮食记录
- ✅ 用药记录
- ✅ 传感器管理
- ✅ 数据共享
- ✅ 个人设置

---

### Phase 2 (增强版) - Month 5-8

| 优先级 | 模块 | 功能 |
|-------|------|------|
| 🟡 P2 | 健康日志 | 运动记录 |
| 🟡 P2 | 健康日志 | 症状记录 |
| 🟡 P2 | 数据分析 | 日/周报告 |
| 🟡 P2 | 医患协作 | 安全消息 |
| 🟡 P2 | 医患协作 | 预约管理 |
| 🟡 P2 | 教育 | 知识库 |
| 🟡 P2 | 设置 | 数据导出(PDF/CSV) |

---

### Phase 3 (完整版) - Month 9-12

| 优先级 | 模块 | 功能 |
|-------|------|------|
| 🟢 P3 | 数据分析 | 趋势洞察(AI) |
| 🟢 P3 | 教育 | 个性化建议 |
| 🟢 P3 | 教育 | 成就系统 |
| 🟢 P3 | 警报 | 紧急联系人通知 |
| 🟢 P3 | 健康日志 | 照片记录+OCR |
| 🟢 P3 | 集成 | Apple Health/Google Fit |

---

## 4. 用户旅程

### 4.1 新用户首次使用

```
1. 下载App (App Store/Google Play)
   ↓
2. 注册账户
   - 手机号/邮箱
   - 设置密码
   - MFA验证
   ↓
3. 完善个人资料
   - 基本信息(年龄、性别)
   - 糖尿病类型
   - 血糖目标
   ↓
4. 配对CGM传感器
   - 扫描序列号
   - 激活传感器
   - 等待2小时预热
   ↓
5. 设置警报
   - 推荐阈值(可修改)
   - 声音/振动设置
   - 权限授予(通知、定位)
   ↓
6. 引导教程
   - 如何查看血糖
   - 如何记录饮食
   - 如何联系医生
   ↓
7. 开始使用!
```

**首次使用优化**:
- 整个流程<10分钟
- 提供跳过选项(后续可补充)
- 推荐默认设置

---

### 4.2 日常使用场景

**场景1: 早晨起床**
```
1. 打开App
2. 查看睡眠期间血糖曲线
3. 查看当前血糖(空腹)
4. 记录早餐(碳水)
5. 注射餐时胰岛素(记录)
6. 设置餐后2小时提醒
```

**场景2: 接收低血糖警报**
```
1. 手机震动+警报音响起
2. 全屏显示"低血糖警报: 65 mg/dL"
3. 用户摄入果汁(快速碳水)
4. 标记"已处理"
5. 15分钟后复查血糖
6. 记录处理过程(给医生参考)
```

**场景3: 睡前检查**
```
1. 查看今日血糖总结
2. 查看TIR达标情况
3. 确认睡前血糖>120 mg/dL
4. 设置夜间警报(仅紧急低血糖)
5. 查看明日医生预约提醒
```

---

## 5. 界面设计原则

### 5.1 设计语言

**色彩系统**:
```
主色调: 医疗蓝 (#2E86DE)
辅助色:
- 成功绿: #34C759 (目标达成)
- 警告黄: #FFCC00 (注意)
- 危险红: #FF3B30 (警报)

血糖色彩编码:
- 低(<70):   红色 #FF3B30
- 正常(70-180): 绿色 #34C759
- 高(>180):  黄色 #FFCC00
- 极高(>250): 橙色 #FF9500
```

**字体**:
- 主字体: SF Pro (iOS) / Roboto (Android)
- 血糖数值: 粗体、大字号(48pt+)
- 普通文字: 常规(16pt)
- 辅助文字: 细体(14pt)

---

### 5.2 可用性原则

**原则1: 一目了然**
- 当前血糖值必须在首屏最显眼位置
- 使用色彩编码(绿/黄/红)快速识别状态
- 趋势箭头直观显示变化方向

**原则2: 快速操作**
- 首页提供快捷操作按钮(记录餐食/运动)
- 最多3次点击完成任何核心功能
- 支持语音输入(记录备注)

**原则3: 容错性**
- 输入异常值时二次确认
- 删除数据前提示确认
- 支持撤销操作(30秒内)

**原则4: 辅助功能**
- 支持动态字体(iOS Dynamic Type)
- 支持VoiceOver/TalkBack(屏幕阅读器)
- 色盲友好(不仅依赖颜色,配合图标)
- 支持单手操作(底部导航)

---

### 5.3 界面布局

**标准App结构**:
```
┌─────────────────────────────────────┐
│  导航栏 (标题 + 通知 + 设置)         │
├─────────────────────────────────────┤
│                                     │
│                                     │
│        主内容区                      │
│       (滚动内容)                     │
│                                     │
│                                     │
│                                     │
├─────────────────────────────────────┤
│  底部导航栏 (5个Tab)                 │
│  [首页][报告][日志][医生][我的]      │
└─────────────────────────────────────┘
```

**底部导航(Tab Bar)**:
- 🏠 首页(实时监测)
- 📊 报告(AGP/统计)
- 📝 日志(饮食/运动/用药)
- 👨‍⚕️ 医生(医患协作)
- ⚙️ 我的(设置)

---

## 6. 技术实现要点

### 6.1 技术栈

**前端**:
```
移动端: React Native 0.72+
- 跨平台(iOS + Android)
- 热更新(CodePush)
- 原生模块:蓝牙、推送通知

UI组件库: React Native Elements / NativeBase
图表库: Victory Native (血糖曲线)
状态管理: Redux + Redux Toolkit
本地存储: SQLite (realm/watermelonDB)
网络请求: Axios + React Query
```

**后端集成**:
```
API: RESTful API (JSON)
认证: JWT + OAuth 2.0 (与CGM API)
实时通信: WebSocket (可选,用于实时警报)
推送通知: FCM (Android) + APNs (iOS)
```

---

### 6.2 关键技术挑战

**挑战1: 与CGM API集成**
```javascript
// 示例:从CGM API拉取血糖数据
async function fetchGlucoseData() {
  try {
    const response = await axios.get(
      'https://cgm-api.vendor.com/v1/glucose',
      {
        headers: {
          'Authorization': `Bearer ${accessToken}`,
        },
        params: {
          startTime: '2025-10-10T00:00:00Z',
          endTime: '2025-10-10T23:59:59Z',
        }
      }
    );

    // 数据验证
    const glucoseData = response.data.map(item => {
      if (item.value < 20 || item.value > 600) {
        throw new Error('异常血糖值');
      }
      return {
        timestamp: item.timestamp,
        value: item.value,
        trend: item.trend, // ↑↗→↘↓
      };
    });

    // 存储到本地数据库
    await saveToLocalDB(glucoseData);

    // 触发警报检查
    checkAlerts(glucoseData);

  } catch (error) {
    // 错误处理:显示"数据同步失败"
    handleAPIError(error);
  }
}
```

**挑战2: 本地警报逻辑**
```javascript
// 警报逻辑必须本地化(不依赖网络)
function checkAlerts(glucoseData) {
  const latestGlucose = glucoseData[glucoseData.length - 1];
  const userSettings = getUserAlertSettings();

  // 低血糖检查
  if (latestGlucose.value < userSettings.lowThreshold) {
    if (latestGlucose.value < 55) {
      // 紧急低血糖
      triggerCriticalAlert({
        type: 'CRITICAL_LOW',
        value: latestGlucose.value,
        message: '紧急低血糖!请立即摄入快速碳水',
      });
    } else {
      // 低血糖
      triggerAlert({
        type: 'LOW',
        value: latestGlucose.value,
        message: '低血糖警报',
      });
    }
  }

  // 快速下降检查
  if (latestGlucose.trend === '↓') {
    const rate = calculateDropRate(glucoseData);
    if (rate > 3) { // >3 mg/dL/min
      triggerAlert({
        type: 'RAPID_DROP',
        value: latestGlucose.value,
        message: '血糖快速下降',
      });
    }
  }
}
```

**挑战3: 后台运行与电量优化**
```javascript
// iOS: Background Modes
// - Background fetch (定期拉取数据)
// - Remote notifications (服务器推送)

// Android: Foreground Service
// 保持应用在后台运行,接收CGM数据

// 电量优化:
// - 使用CGM API的推送机制(而非轮询)
// - 数据更新频率:5分钟(不需要1分钟)
// - 后台任务节流
```

---

### 6.3 数据模型

**本地数据库Schema**:
```sql
-- 血糖数据表
CREATE TABLE glucose_readings (
  id INTEGER PRIMARY KEY,
  timestamp DATETIME NOT NULL,
  value REAL NOT NULL, -- mg/dL
  trend TEXT, -- ↑↗→↘↓
  source TEXT, -- 'cgm' or 'manual'
  sensor_id TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 警报事件表
CREATE TABLE alert_events (
  id INTEGER PRIMARY KEY,
  timestamp DATETIME NOT NULL,
  type TEXT NOT NULL, -- 'LOW', 'HIGH', 'RAPID_DROP'
  glucose_value REAL,
  acknowledged BOOLEAN DEFAULT 0,
  acknowledged_at DATETIME,
  notes TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 饮食记录表
CREATE TABLE meal_logs (
  id INTEGER PRIMARY KEY,
  timestamp DATETIME NOT NULL,
  meal_type TEXT, -- 'breakfast', 'lunch', 'dinner', 'snack'
  carbs REAL, -- 碳水克数
  photos TEXT, -- JSON array of photo URLs
  notes TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 用药记录表
CREATE TABLE medication_logs (
  id INTEGER PRIMARY KEY,
  timestamp DATETIME NOT NULL,
  medication_type TEXT, -- 'insulin_rapid', 'insulin_long', 'oral'
  dose REAL,
  injection_site TEXT,
  notes TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

---

## 7. 监管考虑

### 7.1 功能的监管风险评估

| 功能 | 风险等级 | 原因 | 缓解措施 |
|------|---------|------|---------|
| **血糖显示** | 🔴 高 | 数据错误导致治疗决策错误 | - 100%准确性验证<br>- 与CGM接收器对比测试 |
| **警报功能** | 🔴 高 | 警报失效→低血糖未检出 | - 灵敏度>99%<br>- 本地+云端双重逻辑<br>- 系统级通知 |
| **AGP报告** | 🟡 中 | 医生基于报告做决策 | - 使用国际标准算法<br>- 数据完整性验证 |
| **饮食/运动记录** | 🟢 低 | 仅记录,不提供决策 | - IFU说明:"仅供参考" |
| **健康建议** | 🟠 中 | 可能被误认为治疗建议 | - 通用性建议(非个体化)<br>- 免责声明<br>- 不提供剂量建议 |
| **医患消息** | 🟡 中 | PHI泄露风险 | - 端到端加密<br>- GDPR/HIPAA合规 |

---

### 7.2 免责声明(必需!)

**应用内多处显示**:
```
⚠️ 重要提示

本应用用于辅助糖尿病管理,不替代专业医疗建议、诊断或治疗。

- 所有治疗决策应咨询医生
- 紧急情况请立即就医或拨打急救电话
- 本应用不提供胰岛素剂量建议
- CGM数据可能存在延迟,低血糖时请使用血糖仪确认

[我已阅读并理解]
```

**首次使用时必须确认**

---

### 7.3 IFU中的关键警告

**使用说明书(IFU)必须包含**:
- ⚠️ 本应用必须与[CGM型号]配合使用
- ⚠️ 需要持续网络连接以接收及时警报
- ⚠️ 低血糖症状时,使用血糖仪确认
- ⚠️ 不用于紧急医疗情况
- ⚠️ 定期检查传感器准确性
- ⚠️ 警报仅供参考,不替代症状判断

---

## 8. 开发路线图

### Phase 1: MVP开发 (Month 1-4)

**Month 1: 基础架构**
- 项目搭建(React Native)
- UI组件库选型
- 本地数据库设计
- 与CGM API集成(Mock)

**Month 2-3: 核心功能**
- 实时血糖显示
- 血糖曲线图
- 警报系统(本地逻辑)
- 传感器管理
- 用户设置

**Month 4: 数据分析**
- AGP报告生成
- TIR计算
- 日/周统计

**里程碑**: MVP Beta版(内部测试)

---

### Phase 2: 增强与测试 (Month 5-8)

**Month 5-6: 增强功能**
- 健康日志(饮食/运动/用药)
- 医患协作(数据共享)
- 安全消息

**Month 7: 测试**
- 互操作性测试(N=30)
- 可用性测试(N=15)
- 渗透测试

**Month 8: 优化**
- Bug修复
- 性能优化
- 文档编写

**里程碑**: v1.0 RC (发布候选版)

---

### Phase 3: 发布与迭代 (Month 9-12)

**Month 9-10: 发布准备**
- App Store审核准备
- CE认证文档提交
- 上线前测试

**Month 11: 正式发布**
- App Store / Google Play上线
- 用户反馈收集

**Month 12: 迭代**
- 趋势洞察(AI)
- 成就系统
- 高级功能

---

## 总结

### ✅ 核心功能清单(MVP)

1. **实时血糖监测** - 当前值、趋势、曲线图
2. **智能警报** - 低/高血糖、快速变化警报
3. **AGP报告** - 医生诊疗参考
4. **健康日志** - 饮食、用药记录
5. **医患协作** - 数据共享、安全消息
6. **传感器管理** - 配对、状态监测
7. **个人设置** - 目标、警报阈值

### 📊 开发估算

- **开发时间**: 8-10个月(MVP + 测试)
- **团队规模**:
  - 产品经理 ×1
  - 前端工程师 ×2-3
  - 后端工程师 ×2
  - QA ×2
  - UI/UX ×1
- **技术栈**: React Native + RESTful API
- **测试重点**: 互操作性(关键!)、警报准确性

### ⚠️ 监管关键点

- ✅ 血糖数据100%准确
- ✅ 警报灵敏度>99%
- ✅ 免责声明多处显示
- ✅ 不提供治疗决策(剂量建议)
- ✅ GDPR/HIPAA合规

---

需要我详细展开某个功能模块吗?比如警报系统的详细技术方案,或AGP报告的算法实现?